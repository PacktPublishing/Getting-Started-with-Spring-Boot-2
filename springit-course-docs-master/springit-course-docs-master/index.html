<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.2">
<meta name="author" content="Dan Vega">
<title>Getting Started with Spring Boot 2.0</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<link href="prism/prism.css" rel="stylesheet" />
<style>
    /* Override Asciidoctor CSS to get the correct background */
    .listingblock pre[class^="highlight "] {
        background: #272822;
    }
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Getting Started with Spring Boot 2.0</h1>
<div class="details">
<span id="author" class="author">Dan Vega</span><br>
<span id="email" class="email"><a href="mailto:danvega@gmail.com">danvega@gmail.com</a></span><br>
<span id="revnumber">version 0.1,</span>
<span id="revdate">April 14, 2018</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_course_details">Course Details</a>
<ul class="sectlevel2">
<li><a href="#_about">About</a></li>
<li><a href="#_prerequisites">Prerequisites</a></li>
<li><a href="#_requirements">Requirements</a></li>
<li><a href="#_curriculum">Curriculum</a></li>
<li><a href="#_course_project">Course Project</a></li>
<li><a href="#_course_assets">Course Assets</a></li>
</ul>
</li>
<li><a href="#_development_environment">Development Environment</a>
<ul class="sectlevel2">
<li><a href="#_java">Java</a>
<ul class="sectlevel3">
<li><a href="#_sdkman">SDKMan</a></li>
</ul>
</li>
<li><a href="#_build_tools">Build Tools</a>
<ul class="sectlevel3">
<li><a href="#_maven">Maven</a></li>
<li><a href="#_gradle">Gradle</a></li>
</ul>
</li>
<li><a href="#_ide_text_editors">IDE &amp; Text Editors</a>
<ul class="sectlevel3">
<li><a href="#_intellij">IntelliJ</a></li>
<li><a href="#_spring_tool_suite_eclipse">Spring Tool Suite (Eclipse)</a></li>
<li><a href="#_visual_studio_code">Visual Studio Code</a></li>
</ul>
</li>
<li><a href="#_amazon_web_services_aws">Amazon Web Services (AWS)</a></li>
</ul>
</li>
<li><a href="#_what_s_new_in_spring">What&#8217;s new in Spring</a>
<ul class="sectlevel2">
<li><a href="#_spring_framework_5">Spring Framework 5</a>
<ul class="sectlevel3">
<li><a href="#_jdk_8_and_java_ee_7_baseline">JDK 8+ and Java EE 7+ Baseline</a></li>
<li><a href="#_removed_packages_classes_and_methods">Removed Packages, Classes and Methods</a></li>
<li><a href="#_general_core_revision">General Core Revision</a></li>
<li><a href="#_core_container">Core Container</a></li>
<li><a href="#_spring_web_mvc">Spring Web MVC</a></li>
<li><a href="#_spring_webflux">Spring WebFlux</a></li>
<li><a href="#_kotlin_support">Kotlin support</a></li>
<li><a href="#_testing_improvements">Testing Improvements</a></li>
</ul>
</li>
<li><a href="#_spring_boot_2">Spring Boot 2</a>
<ul class="sectlevel3">
<li><a href="#_spring_boot_history">Spring Boot History</a></li>
<li><a href="#_what_s_new_in_spring_2">What&#8217;s new in Spring </a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_github">Github</a>
<ul class="sectlevel2">
<li><a href="#_repositories">Repositories</a>
<ul class="sectlevel3">
<li><a href="#_main_repo">Main Repo</a></li>
<li><a href="#_ui_templates">UI Templates</a></li>
</ul>
</li>
<li><a href="#_learning">Learning</a></li>
<li><a href="#_using_git_github">Using Git &amp; Github</a></li>
</ul>
</li>
<li><a href="#_spring_boot_essentials">Spring Boot Essentials</a>
<ul class="sectlevel2">
<li><a href="#_actuator">Actuator</a></li>
</ul>
</li>
<li><a href="#_building_springit">Building Springit</a>
<ul class="sectlevel2">
<li><a href="#_spring_mvc_model">Spring MVC: Model</a>
<ul class="sectlevel3">
<li><a href="#_jpa">JPA</a></li>
<li><a href="#_spring_data">Spring Data</a></li>
<li><a href="#_spring_data_jpa">Spring Data JPA</a></li>
<li><a href="#_entities">Entities</a></li>
<li><a href="#_project_lombok">Project Lombok</a></li>
<li><a href="#_repositories_2">Repositories</a></li>
<li><a href="#_entity_relationships_mappings">Entity Relationships (Mappings)</a></li>
<li><a href="#_auditing">Auditing</a></li>
</ul>
</li>
<li><a href="#_database_layer">Database Layer</a>
<ul class="sectlevel3">
<li><a href="#_common_application_properties">Common Application Properties</a></li>
<li><a href="#_h2">H2</a></li>
<li><a href="#_mysql">MySQL</a></li>
<li><a href="#_initialize_a_database">Initialize a database</a></li>
<li><a href="#_command_line_runner">Command Line Runner</a></li>
</ul>
</li>
<li><a href="#_spring_mvc_controller">Spring MVC: Controller</a>
<ul class="sectlevel3">
<li><a href="#_controller_introduction">Controller Introduction</a></li>
<li><a href="#_controller_vs_restcontroller">@Controller vs @RestController</a></li>
<li><a href="#_link_controller">Link Controller</a></li>
</ul>
</li>
<li><a href="#_spring_mvc_the_view_layer">Spring MVC: The View Layer</a>
<ul class="sectlevel3">
<li><a href="#_introduction_to_views">Introduction to views</a></li>
<li><a href="#_templates">Templates</a></li>
<li><a href="#_hello_thymeleaf">Hello, Thymeleaf!</a></li>
<li><a href="#_springit_templates">SpringIt Templates</a></li>
<li><a href="#_thymeleaf_layouts">Thymeleaf Layouts</a></li>
<li><a href="#_building_our_link_list_page">Building our Link List Page</a></li>
<li><a href="#_building_our_link_view_page">Building our Link View Page</a></li>
<li><a href="#_building_our_submit_page">Building our Submit Page</a></li>
</ul>
</li>
<li><a href="#_spring_security">Spring Security</a>
<ul class="sectlevel3">
<li><a href="#_spring_security_introduction">Spring Security Introduction</a></li>
<li><a href="#_spring_security_configuration">Spring Security Configuration</a></li>
<li><a href="#_users_roles">Users &amp; Roles</a></li>
<li><a href="#_user_role_entities">User &amp; Role Entities</a></li>
<li><a href="#_user_details_service">User Details Service</a></li>
<li><a href="#_databaseloader_adding_users_roles">DatabaseLoader - Adding Users &amp; Roles</a></li>
<li><a href="#_auditing_2">Auditing</a></li>
<li><a href="#_actuator_security">Actuator Security</a></li>
<li><a href="#_spring_security_the_view_layer">Spring Security: The View Layer</a></li>
<li><a href="#_form_login_logout">Form Login &amp; Logout</a></li>
<li><a href="#_thymeleaf_spring_security">Thymeleaf + Spring Security</a></li>
<li><a href="#_who_submitted_the_link">Who Submitted the link</a></li>
<li><a href="#_account_registration">Account &amp; Registration</a></li>
</ul>
</li>
<li><a href="#_voting">Voting</a>
<ul class="sectlevel3">
<li><a href="#_voting_2">Voting</a></li>
<li><a href="#_vote_entity_repository">Vote Entity &amp; Repository</a></li>
<li><a href="#_vote_controller">Vote Controller</a></li>
<li><a href="#_up_vote_down_vote">Up Vote &amp; Down Vote</a></li>
</ul>
</li>
<li><a href="#_comments">Comments</a>
<ul class="sectlevel3">
<li><a href="#_databaseloader">DatabaseLoader</a></li>
<li><a href="#_list_comments">List Comments</a></li>
<li><a href="#_add_new_comment">Add New Comment</a></li>
</ul>
</li>
<li><a href="#_spring_mvc_the_service_layer">Spring MVC: The Service Layer</a>
<ul class="sectlevel3">
<li><a href="#_user_service">User Service</a></li>
<li><a href="#_transactional">@Transactional</a></li>
<li><a href="#_registration_process">Registration process</a></li>
<li><a href="#_user_refactoring">User Refactoring</a></li>
<li><a href="#_registration_form">Registration Form</a></li>
<li><a href="#_registration_controller">Registration Controller</a></li>
<li><a href="#_registration_process_2">Registration Process</a></li>
<li><a href="#_local_email_server_setup">Local Email Server Setup</a></li>
<li><a href="#_exercise_refactor_existing_controllers">Exercise: Refactor Existing Controllers</a></li>
<li><a href="#_alias_availability_feature">Alias Availability Feature</a></li>
<li><a href="#_transactional_2">@Transactional</a></li>
<li><a href="#_custom_password_validatior">Custom password validatior</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_resources">Resources</a>
<ul class="sectlevel2">
<li><a href="#_spring_documentation">Spring Documentation</a>
<ul class="sectlevel3">
<li><a href="#_spring_framework_5_2">Spring Framework 5</a></li>
<li><a href="#_spring_boot">Spring Boot</a></li>
</ul>
</li>
<li><a href="#_spring_source_code">Spring Source Code</a>
<ul class="sectlevel3">
<li><a href="#_spring_framework">Spring Framework</a></li>
<li><a href="#_spring_boot_3">Spring Boot</a></li>
</ul>
</li>
<li><a href="#_books">Books</a></li>
<li><a href="#_websites">Websites</a></li>
<li><a href="#_blog">Blog</a></li>
<li><a href="#_twitter">Twitter</a></li>
</ul>
</li>
<li><a href="#_join_our_community">Join our Community</a></li>
<li><a href="#_contact_me">Contact Me</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This is the documentation for my course titled "Getting Started with Spring Boot 2". This documentation will be a central
repository for a lot of the course details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_course_details">Course Details</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you&#8217;re reading this document than you have most likely signed up for my course "Getting Started
with Spring Boot 2". I want to thank you for supporting me and taking the time to invest
in yourself. I hope you enjoy this course and if you have any questions please feel free to
<a href="#_contact_me">contact me</a>.</p>
</div>
<div class="sect2">
<h3 id="_about">About</h3>
<div class="paragraph">
<p>This course offers hands-on experience building Spring Framework applications using Spring Boot. The first thing that is going to stand out is that we are going to move away from the boring, non-useful demos. In the new course, we are going to build a practical application from start to finish. This will allow you to see the process I use for building applications from idea to launch.</p>
</div>
<div class="paragraph">
<p>One of the big thing I heard from my students in my first course is that they wanted more information on how to go into production. A great application isn’t that useful if we can deploy it into a production environment. We will take a look at using one of the most popular cloud services around, Amazon Web Services (AWS). On completion, students will have the foundation they need to build enterprise-ready Java applications.</p>
</div>
</div>
<div class="sect2">
<h3 id="_prerequisites">Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>Java Developer</p>
</li>
<li>
<p>Web Development</p>
</li>
<li>
<p>Git &amp; Github</p>
</li>
<li>
<p>Heard of Spring Framework &amp; Spring Boot</p>
</li>
<li>
<p>You want to see some of the new features in:</p>
<div class="ulist">
<ul>
<li>
<p>Spring Framework 5</p>
</li>
<li>
<p>Spring Boot 2.0</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_requirements">Requirements</h3>
<div class="ulist">
<ul>
<li>
<p>Java 9</p>
</li>
<li>
<p>Mac OS / Windows / Linux</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_curriculum">Curriculum</h3>
<div class="ulist">
<ul>
<li>
<p>Introduction</p>
<div class="ulist">
<ul>
<li>
<p>Course Introduction</p>
</li>
<li>
<p>Goals for this course</p>
</li>
<li>
<p>Development Environment Setup</p>
</li>
<li>
<p>Course Documentation</p>
</li>
<li>
<p>Spring Framework vs Spring Boot</p>
</li>
</ul>
</div>
</li>
<li>
<p>Project Overview</p>
<div class="ulist">
<ul>
<li>
<p>Introduction</p>
</li>
<li>
<p>Create the Initial Project</p>
</li>
<li>
<p>Running with Spring Boot</p>
</li>
<li>
<p>Requirements</p>
</li>
<li>
<p>UI Intro</p>
</li>
<li>
<p>UI Templates</p>
</li>
<li>
<p>Domain Model</p>
</li>
</ul>
</div>
</li>
<li>
<p>Github</p>
<div class="ulist">
<ul>
<li>
<p>Introduction</p>
</li>
<li>
<p>Create the initial repository</p>
</li>
<li>
<p>README setup</p>
</li>
<li>
<p>Branching strategy</p>
</li>
</ul>
</div>
</li>
<li>
<p>Spring Boot Essentials</p>
<div class="ulist">
<ul>
<li>
<p>Introduction</p>
</li>
<li>
<p>Spring Boot devtools</p>
</li>
<li>
<p>Configuration &amp; Properties</p>
</li>
<li>
<p>Profiles</p>
</li>
<li>
<p>Debugging &amp; Logging</p>
</li>
<li>
<p>Actuator</p>
</li>
</ul>
</div>
</li>
<li>
<p>Spring MVC: Model</p>
<div class="ulist">
<ul>
<li>
<p>Spring Data JPA Introduction</p>
</li>
<li>
<p>Link Entity &amp; Repository</p>
</li>
<li>
<p>Project Lombok Refactor</p>
</li>
<li>
<p>Comment &amp; Vote Entities</p>
</li>
<li>
<p>Auditing Aware</p>
</li>
</ul>
</div>
</li>
<li>
<p>Database Layer</p>
<div class="ulist">
<ul>
<li>
<p>Properties</p>
</li>
<li>
<p>H2 in memory database setup</p>
</li>
<li>
<p>Creating data using SQL</p>
</li>
<li>
<p>Creating data using Java</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_course_project">Course Project</h3>

</div>
<div class="sect2">
<h3 id="_course_assets">Course Assets</h3>
<div class="paragraph">
<p>If we need to provide a download this would be a great place to link to those assets.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_development_environment">Development Environment</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_java">Java</h3>
<div class="sect3">
<h4 id="_sdkman">SDKMan</h4>

</div>
</div>
<div class="sect2">
<h3 id="_build_tools">Build Tools</h3>
<div class="sect3">
<h4 id="_maven">Maven</h4>

</div>
<div class="sect3">
<h4 id="_gradle">Gradle</h4>

</div>
</div>
<div class="sect2">
<h3 id="_ide_text_editors">IDE &amp; Text Editors</h3>
<div class="sect3">
<h4 id="_intellij">IntelliJ</h4>

</div>
<div class="sect3">
<h4 id="_spring_tool_suite_eclipse">Spring Tool Suite (Eclipse)</h4>

</div>
<div class="sect3">
<h4 id="_visual_studio_code">Visual Studio Code</h4>

</div>
</div>
<div class="sect2">
<h3 id="_amazon_web_services_aws">Amazon Web Services (AWS)</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_s_new_in_spring">What&#8217;s new in Spring</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_spring_framework_5">Spring Framework 5</h3>
<div class="sect3">
<h4 id="_jdk_8_and_java_ee_7_baseline">JDK 8+ and Java EE 7+ Baseline</h4>
<div class="ulist">
<ul>
<li>
<p>Entire framework codebase based on Java 8 source code level now.</p>
<div class="ulist">
<ul>
<li>
<p>Improved readability through inferred generics, lambdas, etc.</p>
</li>
<li>
<p>Conditional support for Java 8 features now in straight code.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Full compatibility with JDK 9 for development and deployment.</p>
<div class="ulist">
<ul>
<li>
<p>On classpath as well as module path (with stable automatic module names).</p>
</li>
<li>
<p>Framework build and test suite passes on JDK 9 (runs on JDK 8 by default).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Java EE 7 API level required in Spring&#8217;s corresponding features now.</p>
<div class="ulist">
<ul>
<li>
<p>Servlet 3.1, Bean Validation 1.1, JPA 2.1, JMS 2.0</p>
</li>
<li>
<p>Recent servers: e.g. Tomcat 8.5+, Jetty 9.4+, WildFly 10+</p>
</li>
</ul>
</div>
</li>
<li>
<p>Compatibility with Java EE 8 API level at runtime.</p>
<div class="ulist">
<ul>
<li>
<p>Servlet 4.0, Bean Validation 2.0, JPA 2.2, JSON Binding API 1.0</p>
</li>
<li>
<p>Tested against Tomcat 9.0, Hibernate Validator 6.0, Apache Johnzon 1.1</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_removed_packages_classes_and_methods">Removed Packages, Classes and Methods</h4>
<div class="ulist">
<ul>
<li>
<p>Package beans.factory.access (BeanFactoryLocator mechanism).</p>
</li>
<li>
<p>Package jdbc.support.nativejdbc (NativeJdbcExtractor mechanism).</p>
</li>
<li>
<p>Package mock.staticmock removed from spring-aspects module.</p>
<div class="ulist">
<ul>
<li>
<p>No support for AnnotationDrivenStaticEntityMockingControl anymore.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Packages web.view.tiles2 and orm.hibernate3/hibernate4 dropped.</p>
<div class="ulist">
<ul>
<li>
<p>Minimum requirement: Tiles 3 and Hibernate 5 now.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Dropped support: Portlet, Velocity, JasperReports, XMLBeans, JDO, Guava.</p>
<div class="ulist">
<ul>
<li>
<p>Recommendation: Stay on Spring Framework 4.3.x for those if needed.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Many deprecated classes and methods removed across the codebase.</p>
<div class="ulist">
<ul>
<li>
<p>A few compromises made for commonly used methods in the ecosystem.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_general_core_revision">General Core Revision</h4>
<div class="ulist">
<ul>
<li>
<p>JDK 8+ enhancements:</p>
<div class="ulist">
<ul>
<li>
<p>Efficient method parameter access based on Java 8 reflection enhancements.</p>
</li>
<li>
<p>Selective declarations of Java 8 default methods in core Spring interfaces.</p>
</li>
<li>
<p>Consistent use of JDK 7 Charset and StandardCharsets enhancements.</p>
</li>
</ul>
</div>
</li>
<li>
<p>JDK 9 compatibility:</p>
<div class="ulist">
<ul>
<li>
<p>Avoiding JDK APIs which are deprecated in JDK 9 wherever possible.</p>
</li>
<li>
<p>Consistent instantiation via constructors (with revised exception handling).</p>
</li>
<li>
<p>Defensive use of reflection against core JDK classes.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Non-null API declaration at the package level:</p>
<div class="ulist">
<ul>
<li>
<p>Nullable arguments, fields and return values explicitly annotated with @Nullable.</p>
</li>
<li>
<p>Primarily for use with IntelliJ IDEA and Kotlin, but also Eclipse and FindBugs.</p>
</li>
<li>
<p>Some Spring APIs are not tolerating null values anymore (e.g. in StringUtils).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Resource abstraction provides isFile indicator for defensive getFile access.</p>
<div class="ulist">
<ul>
<li>
<p>Also features NIO-based readableChannel accessor in the Resource interface.</p>
</li>
<li>
<p>File system access via NIO.2 streams (no FileInput/OutputStream used anymore).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Spring Framework 5.0 comes with its own Commons Logging bridge out of the box:</p>
<div class="ulist">
<ul>
<li>
<p>spring-jcl instead of standard Commons Logging; still excludable/overridable.</p>
</li>
<li>
<p>Autodetecting Log4j 2.x, SLF4J, JUL (java.util.logging) without any extra bridges.</p>
</li>
</ul>
</div>
</li>
<li>
<p>spring-core comes with ASM 6.0 (next to CGLIB 3.2.5 and Objenesis 2.6).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_core_container">Core Container</h4>
<div class="ulist">
<ul>
<li>
<p>Support for any @Nullable annotations as indicators for optional injection points.</p>
</li>
<li>
<p>Functional style on GenericApplicationContext/AnnotationConfigApplicationContext</p>
<div class="ulist">
<ul>
<li>
<p>Supplier-based bean registration API with bean definition customizer callbacks.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Consistent detection of transaction, caching, async annotations on interface methods.</p>
<div class="ulist">
<ul>
<li>
<p>In case of CGLIB proxies.</p>
</li>
</ul>
</div>
</li>
<li>
<p>XML configuration namespaces streamlined towards unversioned schemas.</p>
<div class="ulist">
<ul>
<li>
<p>Always resolved against latest xsd files; no support for deprecated features.</p>
</li>
<li>
<p>Version-specific declarations still supported but validated against latest schema.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Support for candidate component index (as alternative to classpath scanning).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_spring_web_mvc">Spring Web MVC</h4>
<div class="ulist">
<ul>
<li>
<p>Full Servlet 3.1 signature support in Spring-provided Filter implementations.</p>
</li>
<li>
<p>Support for Servlet 4.0 PushBuilder argument in Spring MVC controller methods.</p>
</li>
<li>
<p>MaxUploadSizeExceededException for Servlet 3.0 multipart parsing on common servers.</p>
</li>
<li>
<p>Unified support for common media types through MediaTypeFactory delegate.</p>
<div class="ulist">
<ul>
<li>
<p>Superseding use of the Java Activation Framework.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Data binding with immutable objects (Kotlin / Lombok / @ConstructorProperties)</p>
</li>
<li>
<p>Support for the JSON Binding API (with Eclipse Yasson or Apache Johnzon as an alternative to Jackson and GSON).</p>
</li>
<li>
<p>Support for Jackson 2.9.</p>
</li>
<li>
<p>Support for Protobuf 3.</p>
</li>
<li>
<p>Support for Reactor 3.1 Flux and Mono as well as RxJava 1.3 and 2.1 as return values from Spring MVC controller methods targeting use of the new reactive WebClient (see below) or Spring Data Reactive repositories in Spring MVC controllers.</p>
</li>
<li>
<p>New ParsingPathMatcher alternative to AntPathMatcher with more efficient parsing and extended syntax.</p>
</li>
<li>
<p>@ExceptionHandler methods allow RedirectAttributes arguments (and therefore flash attributes).</p>
</li>
<li>
<p>Support for ResponseStatusException as a programmatic alternative to @ResponseStatus.</p>
</li>
<li>
<p>Support script engines that do not implement Invocable via direct rendering of the script provided using ScriptEngine#eval(String, Bindings), and also i18n and nested templates in ScriptTemplateView via the new RenderingContext parameter.</p>
</li>
<li>
<p>Spring&#8217;s FreeMarker macros (spring.ftl) use HTML output formatting now (requiring FreeMarker 2.3.24+).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_spring_webflux">Spring WebFlux</h4>
<div class="ulist">
<ul>
<li>
<p>New spring-webflux module, an alternative to spring-webmvc built on a reactive foundation&#8201;&#8212;&#8201;fully asynchronous and non-blocking, intended for use in an event-loop execution model vs traditional large thread pool with thread-per-request execution model.</p>
</li>
<li>
<p>Reactive infrastructure in spring-core such as Encoder and Decoder for encoding and decoding streams of Objects; DataBuffer abstraction, e.g. for using Java ByteBuffer or Netty ByteBuf; ReactiveAdapterRegistry for transparent support of reactive libraries in controller method signatures.</p>
</li>
<li>
<p>Reactive infrastructure in spring-web including HttpMessageReader and HttpMessageWriter that build on and delegate to Encoder and Decoder; server HttpHandler with adapters to (non-blocking) runtimes such as Servlet 3.1+ containers, Netty, and Undertow; WebFilter, WebHandler and other non-blocking contract alternatives to Servlet API equivalents.</p>
</li>
<li>
<p>@Controller style, annotation-based, programming model, similar to Spring MVC, but supported in WebFlux, running on a reactive stack, e.g. capable of supporting reactive types as controller method arguments, never blocking on I/O, respecting backpressure all the way to the HTTP socket, and running on extra, non-Servlet containers such as Netty and Undertow.</p>
</li>
<li>
<p>New functional programming model ("WebFlux.fn") as an alternative to the @Controller, annotation-based, programming model&#8201;&#8212;&#8201;minimal and transparent with an endpoint routing API, running on the same reactive stack and WebFlux infrastructure.</p>
</li>
<li>
<p>New WebClient with a functional and reactive API for HTTP calls, comparable to the RestTemplate but through a fluent API and also excelling in non-blocking and streaming scenarios based on WebFlux infrastructure; in 5.0 the AsyncRestTemplate is deprecated in favor of the WebClient.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_kotlin_support">Kotlin support</h4>
<div class="ulist">
<ul>
<li>
<p>Null-safe API when using Kotlin 1.1.50 or higher.</p>
</li>
<li>
<p>Support for Kotlin immutable classes with optional parameters and default values.</p>
</li>
<li>
<p>Functional bean definition Kotlin DSL.</p>
</li>
<li>
<p>Functional routing Kotlin DSL for WebFlux.</p>
</li>
<li>
<p>Leveraging Kotlin reified type parameters to avoid specifying explicitly the Class to use for serialization/deserialization in various APIs like RestTemplate or WebFlux APIs.</p>
</li>
<li>
<p>Kotlin null-safety support for @Autowired/@Inject and @RequestParam/@RequestHeader/etc annotations in order to determine if an injection point or handler method parameter is required or not.</p>
</li>
<li>
<p>Kotlin script support in ScriptTemplateView for both Spring MVC and Spring WebFlux.</p>
</li>
<li>
<p>Array-like setters added to Model, ModelMap and Environment.</p>
</li>
<li>
<p>Support for Kotlin autowired constructor with optional parameters.</p>
</li>
<li>
<p>Kotlin reflection is used to determine interface method parameters.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_testing_improvements">Testing Improvements</h4>
<div class="ulist">
<ul>
<li>
<p>Complete support for JUnit 5&#8217;s Jupiter programming and extension models in the Spring TestContext Framework.</p>
<div class="ulist">
<ul>
<li>
<p>SpringExtension: an implementation of multiple extension APIs from JUnit Jupiter that provides full support for the existing feature set of the Spring TestContext Framework. This support is enabled via @ExtendWith(SpringExtension.class).</p>
</li>
<li>
<p>@SpringJUnitConfig: a composed annotation that combines @ExtendWith(SpringExtension.class) from JUnit Jupiter with @ContextConfiguration from the Spring TestContext Framework.</p>
</li>
<li>
<p>@SpringJUnitWebConfig: a composed annotation that combines @ExtendWith(SpringExtension.class) from JUnit Jupiter with @ContextConfiguration and @WebAppConfiguration from the Spring TestContext Framework.</p>
</li>
<li>
<p>@EnabledIf: signals that the annotated test class or test method is enabled if the supplied SpEL expression or property placeholder evaluates to true.</p>
</li>
<li>
<p>@DisabledIf: signals that the annotated test class or test method is disabled if the supplied SpEL expression or property placeholder evaluates to true.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Support for parallel test execution in the Spring TestContext Framework.</p>
</li>
<li>
<p>New before and after test execution callbacks in the Spring TestContext Framework with support for TestNG, JUnit 5, and JUnit 4 via the SpringRunner (but not via JUnit 4 rules).</p>
<div class="ulist">
<ul>
<li>
<p>New beforeTestExecution() and afterTestExecution() callbacks in the TestExecutionListener API and TestContextManager.</p>
</li>
</ul>
</div>
</li>
<li>
<p>MockHttpServletRequest now has getContentAsByteArray() and getContentAsString() methods for accessing the content (i.e., request body).</p>
</li>
<li>
<p>The print() and log() methods in Spring MVC Test now print the request body if the character encoding has been set in the mock request.</p>
</li>
<li>
<p>The redirectedUrl() and forwardedUrl() methods in Spring MVC Test now support URI templates with variable expansion.</p>
</li>
<li>
<p>XMLUnit support upgraded to 2.3.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This information came straight from the <a href="https://github.com/spring-projects/spring-framework/wiki/What&#8217;s-New-in-Spring-Framework-5.x">Spring Framework Wiki</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spring_boot_2">Spring Boot 2</h3>
<div class="imageblock">
<div class="content">
<img src="images/pexels-photo-273238-2.jpeg" alt="pexels photo 273238 2">
</div>
</div>
<div class="sect3">
<h4 id="_spring_boot_history">Spring Boot History</h4>
<div class="paragraph">
<p>Before we dive into what’s new I want to take this chance to take a quick look at the history of Spring Boot. In a blog post published in August 2013, Phil Webb announced the first milestone release of a new project called Spring Boot.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Spring Boot aims to make it easy to create Spring-powered, production-grade applications and services with minimum fuss. It takes an opinionated view of the Spring platform so that new and existing users can quickly get to the bits they need. You can use it to create stand-alone Java applications that can be started using ‘java -jar’ or more traditional WAR deployments. </p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>About 9 months later in April 2014 Spring Boot 1.0 was released. Since then there have been numerous minor releases that have brought us some really great features. </p>
</div>
<div class="ulist">
<ul>
<li>
<p>Spring Boot 1.1 (June 2014) </p>
<div class="ulist">
<ul>
<li>
<p>spring-boot-starter-test</p>
</li>
<li>
<p>Metrics &amp; Health Endpoints</p>
</li>
<li>
<p>Elastic Search, Apache Solr, Spring Social &amp; Spring Integration Auto-configuration </p>
</li>
<li>
<p>Additional Templating support (Adding Freemaker, Groov, and Velocity)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Spring Boot 1.2 (March 2015) </p>
<div class="ulist">
<ul>
<li>
<p>Servlet 3.1, Tomcat 8 &amp; Jetty 9</p>
</li>
<li>
<p>Spring 4.1</p>
</li>
<li>
<p>@SpringBootApplication Annotation</p>
</li>
<li>
<p>Email Support</p>
</li>
</ul>
</div>
</li>
<li>
<p>Spring Boot 1.3 (December 2016)</p>
<div class="ulist">
<ul>
<li>
<p>Upgrade to Spring Framework 4.2</p>
</li>
<li>
<p>Upgrade to Spring Security 4.0</p>
</li>
<li>
<p>Developer Tools</p>
</li>
<li>
<p>Caching Auto-configuration </p>
</li>
<li>
<p>Fully executable JARs and service support</p>
</li>
</ul>
</div>
</li>
<li>
<p>Spring Boot 1.4 (January 2017)</p>
<div class="ulist">
<ul>
<li>
<p>Spring 4.3</p>
</li>
<li>
<p>Hibernate 5</p>
</li>
<li>
<p>Testing Improvements</p>
</li>
<li>
<p>Integration Starter</p>
</li>
<li>
<p>Couchbase and Neo4J Support</p>
</li>
</ul>
</div>
</li>
<li>
<p>Spring Boot 1.5 (February 2017)</p>
<div class="ulist">
<ul>
<li>
<p>Loggers endpoint</p>
</li>
<li>
<p>Apache Kafka support</p>
</li>
<li>
<p>Cloud Foundry actuator extensions</p>
</li>
<li>
<p>LDAP support</p>
</li>
<li>
<p>Testing updates</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_what_s_new_in_spring_2">What&#8217;s new in Spring </h4>
<div class="paragraph">
<p>What&#8217;s new in Spring Boot 2? If we are going to talk about the biggest feature we need to start with the upgrade to Spring Framework 5. While Spring Framework 5 has been out since September 2017, most developers (like me) have been waiting for the release of Spring Boot 2. Spring Framework 5 introduces a long list of new features but I just want to touch on a few of the major ones here.</p>
</div>
<div class="sect4">
<h5 id="_what_s_new_in_spring_framework_5">What’s new in Spring Framework 5</h5>
<div class="imageblock">
<div class="content">
<img src="images/mark-solarski-209233-unsplash.jpg" alt="mark solarski 209233 unsplash">
</div>
</div>
<div class="paragraph">
<p><strong>Java 8+ Baseline</strong></p>
</div>
<div class="paragraph">
<p>If you wish to build Spring Framework applications going forward you must be on a minimum of Java 8. Your first thought might be this is a great change for all of us but in fact its an even bigger one for the Spring team. This gave them a chance to make some major changes to update the code base to all the new features in Java 8 like Lambdas and streams. This not only ads readability throughout the code but also offers some performance improvements to the core of the framework. </p>
</div>
<div class="paragraph">
<p><strong>Java 9 Support</strong></p>
</div>
<div class="paragraph">
<p>If you want to use Java 9 you will need to update to Spring Framework 5 and therefore need to update to Spring Boot 2. I know many of us might not be on the latest and greatest version of Java in production but this is a great chance for you to play around with all the cool new toys. This works pretty seamlessly out of the box using the standard classpath but I have read a few people having issues moving to Java 9 modules. </p>
</div>
<div class="paragraph">
<p><strong>Spring MVC</strong></p>
</div>
<div class="paragraph">
<p>While Spring MVC isn&#8217;t the main character in this story there were some nice upgrades. I won&#8217;t go through them all here so head over to documentation for Spring Framework 5.</p>
</div>
<div class="paragraph">
<p><strong>Spring Webflux</strong></p>
</div>
<div class="paragraph">
<p>The reactive stack is our main character in the story of Spring Framework 5. This is a different way of thinking but fortunately for us, we don&#8217;t have to learn a whole new way of writing applications. Spring WebFlux is a fully asynchronous and non-blocking web framework built from the ground up allowing us to handle a massive number of concurrent connections. While this is a complete paradigm shift it is really easy to get started. </p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/reactive_stack.png" alt="reactive stack">
</div>
</div>
<div class="paragraph">
<p><strong>Kotlin Support</strong></p>
</div>
<div class="paragraph">
<p>Kotlin support was added to <a href="http://start.spring.io" class="bare">http://start.spring.io</a> but in Spring Framework 5 there is dedicated support for the language. With the dedicated support came some nice features that you can read about here.</p>
</div>
<div class="paragraph">
<p><strong>Testing Improvements</strong></p>
</div>
<div class="paragraph">
<p>The biggest change in the testing landscape is the complete support for JUnit 5&#8217;s Jupiter programming and extension model. I will mention this again later but when you fire up a new Spring Boot 2 application you are still using JUnit 4 by default however it is a simple change if you want to start using JUnit 5. </p>
</div>
</div>
<div class="sect4">
<h5 id="_what_s_new_in_spring_boot_2">What&#8217;s new in Spring Boot 2</h5>
<div class="imageblock">
<div class="content">
<img src="images/jon-tyson-520864d-unsplash.jpg" alt="jon tyson 520864d unsplash">
</div>
</div>
<div class="paragraph">
<p><strong>Third-party Library Upgrades</strong></p>
</div>
<div class="paragraph">
<p>With any new release of Spring Boot, the Spring team has an opportunity to update various dependencies. </p>
</div>
<div class="ulist">
<ul>
<li>
<p>Thymeleaf 3</p>
</li>
<li>
<p>Jetty 9.4</p>
</li>
<li>
<p>Tomcat 8.5</p>
</li>
<li>
<p>Hibernate 5.2</p>
</li>
<li>
<p>Flyway 5</p>
</li>
<li>
<p>Gradle 4</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reactive Spring Data &amp; Spring Security </strong></p>
</div>
<div class="paragraph">
<p>With the move to Spring WebFlux, Spring Data also provides support for reactive applications. Currently, Cassandra, MongoDB, Couchbase and Redis all have reactive API support. Spring Boot includes starter-POMs for all of these which should make getting started really easy. </p>
</div>
<div class="paragraph">
<p>We also gain the ability to use Spring Security 5.0 in our reactive applications. When Spring Security is on the classpath auto-configuration is provided for WebFlux applications.</p>
</div>
<div class="paragraph">
<p><strong>Actuator</strong></p>
</div>
<div class="paragraph">
<p>Spring Boot Actuator is nothing new but it has been rewritten from the ground up. If you&#8217;re not familiar with the Actuator project it automatically exposes endpoints to get information about that status of your application. The Actuator in Spring Boot 1.x was written against the servlet API and with the new reactive stack, the Spring team needed a solution that would work with both. Along with that, there were many changes to Actuator: </p>
</div>
<div class="ulist">
<ul>
<li>
<p>Redesign for both servlet &amp; reactive</p>
</li>
<li>
<p>Status &amp; health (all the details) were separated out</p>
</li>
<li>
<p>Simplified Security model</p>
</li>
<li>
<p>Move to micrometer (think SLF4J but for metrics)</p>
</li>
<li>
<p>Improved JSON Structures</p>
</li>
<li>
<p>Simplified process for creating User-Defined Endpoints.</p>
<div class="ulist">
<ul>
<li>
<p>@Endpoint</p>
</li>
<li>
<p>@WebEndpoint</p>
</li>
<li>
<p>@JmxEndpoint</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pexels-photo-241544.jpeg" alt="pexels photo 241544">
</div>
</div>
<div class="paragraph">
<p>This might be an area that folks have some trouble upgrading because of the security model changes which we will talk about those in a few. By default, all web endpoints are available beneath the path /actuator with URLs of the form /actuator/{id}. The /actuator base path can be configured by using the management.endpoints.web.base-path property.</p>
</div>
<div class="paragraph">
<p>There is a dedicated detailed document for Spring Boot Actuator Web API Endpoints and this is a great place to start. </p>
</div>
<div class="paragraph">
<p><strong>Gradle Plugin</strong></p>
</div>
<div class="paragraph">
<p>I have always been a big fan of Gradle and I am really excited to see that the team took this opportunity to rewrite the Gradle plugin. </p>
</div>
<div class="paragraph">
<p>The Spring Boot Gradle Plugin provides Spring Boot support in Gradle, allowing you to package executable jar or war archives, run Spring Boot applications, and use the dependency management provided by spring-boot-dependencies. Spring Boot’s Gradle plugin requires Gradle 4.0 or later.</p>
</div>
<div class="paragraph">
<p>images::pexels-photo-209728.jpeg[]</p>
</div>
<div class="paragraph">
<p><strong>Getting Started</strong></p>
</div>
<div class="paragraph">
<p>To get started with the plugin it needs to be applied to your project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>buildscript {
	repositories {
		maven { url 'https://repo.spring.io/libs-milestone' }
	}

	dependencies {
		classpath 'org.springframework.boot:spring-boot-gradle-plugin:2.0.0.RC1'
	}
}

apply plugin: 'org.springframework.boot'</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Building executable jars and wars</strong></p>
</div>
<div class="paragraph">
<p>The bootRepackage task has been replaced with bootJar and bootWar tasks for building executable jars and wars respectively. Both tasks extend their equivalent standard Gradle jar or war task, giving you access to all of the usual configuration options and behavior.</p>
</div>
<div class="paragraph">
<p><strong>Dependency management</strong></p>
</div>
<div class="paragraph">
<p>Spring Boot’s Gradle plugin no longer automatically applies the dependency management plugin. Instead, Spring Boot’s plugin now reacts to the dependency management plugin being applied by importing the correct version of the spring-boot-dependencies BOM. This gives you more control over how and when dependency management is configured. For most applications applying the dependency management plugin will be sufficient:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>apply plugin: 'io.spring.dependency-management'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Gradle Plugin also has its own documentation and there is some really great information in there. Anyone that wants to get started using Gradle should start by checking out the link below. </p>
</div>
<div class="paragraph">
<p><strong>Simplified Security </strong></p>
</div>
<div class="paragraph">
<p>In Spring Boot 2.x, one of the main goals was to simplify security configuration and make adding custom security easy. By default, everything is secured, including static resources and Actuator endpoints. If Spring Security is on the classpath, Spring Boot will add @EnableWebSecurity and rely on Spring Security&#8217;s content-negoation to decide which authentication mechanism to use. </p>
</div>
<div class="paragraph">
<p>Once users decide that they want to add custom security, the default security configuration provided by Spring Boot will back off completely. At this point, users need to explicitly define all the bits they want to secure. This means security configuration is now in one place and avoids any kind of ordering issues with existing WebSecurityConfigurerAdapters.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pexels-photo-113726.jpeg" alt="pexels photo 113726">
</div>
</div>
<div class="paragraph">
<p>Here is an example of a custom security:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>http
    .authorizeRequests()
        // 1
        .requestMatchers(EndpointRequest.to("status", "info"))
            .permitAll()
        // 2
        .requestMatchers(EndpointRequest.toAnyEndpoint())
            .hasRole("ACTUATOR")
        // 3
        .requestMatchers(StaticResourceRequest.toCommonLocations())
            .permitAll()
        // 4
        .antMatchers("/**")
            .hasRole("USER")
    .and()
  ... // additional configuration</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>/status and /info endpoints do not require authentication.</p>
</li>
<li>
<p>All other actuator endpoints are protected by the ACTUATOR role.</p>
</li>
<li>
<p>Common static resource locations are open to all.</p>
</li>
<li>
<p>All other application endpoints are protected by the USER role.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Actuator Security </strong></p>
</div>
<div class="paragraph">
<p>With the actuator endpoints locked down, you will need to include or exclude the endpoints you want to see. These are the properties that now control that and have changed since 1.x </p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code># ENDPOINTS WEB CONFIGURATION (WebEndpointProperties)
management.endpoints.web.exposure.include=info,health # Endpoint IDs that should be included or '*' for all.
management.endpoints.web.exposure.exclude= # Endpoint IDs that should be excluded.
management.endpoints.web.base-path=/actuator # Base path for Web endpoints. Relative to server.servlet.context-path or management.server.servlet.context-path if management.server.port is configured.
management.endpoints.web.path-mapping= # Mapping between endpoint IDs and the path that should expose them.
If you're ever unsure what properties to use bookmark the common application properties documentation. </code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>HTTP/2 Support</strong></p>
</div>
<div class="paragraph">
<p>It&#8217;s hard to believe but the HTTP 1.1 specification was released back in 1996. I think this comes without saying but the web is very different today. If you want to enable HTTP/2 in your Spring MVC or WebFlux applications you can use the following property. </p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>server.http2.enabled=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>This support depends on the chosen web server and the application environment since that protocol is not supported out-of-the-box by JDK8. Please <a href="https://docs.spring.io/spring-boot/docs/2.0.x/reference/html/howto-embedded-web-servers.html#howto-configure-http2">check out the documentation</a> for more details. </p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mac-freelancer-macintosh-macbook-40185.jpeg" alt="mac freelancer macintosh macbook 40185">
</div>
</div>
<div class="paragraph">
<p><strong>Configuration Properties</strong></p>
</div>
<div class="paragraph">
<p>In Spring Boot 1.x this notion of relaxed binding was supported and all that meant is there were multiple ways you could create a property name (camel case, underscore, hyphen) and that property would all bind to the same property. </p>
</div>
<div class="paragraph">
<p>This still works the same but what they did tighten up was the way that you read variables in your own code. The @Value annotation is a core container feature, and it does not provide the same features as type-safe configuration properties.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/2018-02-28_07-12-58.png" alt="2018 02 28 07 12 58">
</div>
</div>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-boot/docs/2.0.x/reference/html/boot-features-external-config.html#boot-features-external-config-relaxed-binding">External Config Relaxed Binding</a></p>
</div>
<div class="paragraph">
<p><strong>Metrics</strong></p>
</div>
<div class="paragraph">
<p>Spring Boot’s own metrics have been replaced by Micrometer. This is being developed by Pivotal and quickly being adopted across projects within Pivotal. </p>
</div>
<div class="paragraph">
<p>Spring Boot Actuator provides dependency management and auto-configuration for Micrometer, an application metrics facade that supports numerous monitoring systems, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Atlas</p>
</li>
<li>
<p>Datadog</p>
</li>
<li>
<p>Ganglia</p>
</li>
<li>
<p>Graphite</p>
</li>
<li>
<p>Influx</p>
</li>
<li>
<p>JMX</p>
</li>
<li>
<p>New Relic</p>
</li>
<li>
<p>Prometheus</p>
</li>
<li>
<p>SignalFx</p>
</li>
<li>
<p>Simple (in-memory)</p>
</li>
<li>
<p>StatsD</p>
</li>
<li>
<p>Wavefront</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/micrometer.png" alt="micrometer">
</div>
</div>
<div class="paragraph">
<p>To learn more about Micrometer visit <a href="https://micrometer.io/" class="bare">https://micrometer.io/</a></p>
</div>
<div class="paragraph">
<p>This might cause a little bit of an upgrade pain for those doing a ton of logging of custom metrics.</p>
</div>
<div class="paragraph">
<p><strong>Quartz Scheduler</strong></p>
</div>
<div class="paragraph">
<p>Spring Boot 2 provides support for the Quartz scheduler that can be used via the spring-boot-starter-quartz dedicated starter. Both in-memory and JDBC stores can be configured.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
	&lt;artifactId&gt;spring-boot-starter-quartz&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pexels-photo-768472.jpeg" alt="pexels photo 768472">
</div>
</div>
<div class="paragraph">
<p><strong>HikariCP Connection Pool</strong></p>
</div>
<div class="paragraph">
<p>The default connection pool has switched from Tomcat to HikariCP. If you used spring.datasource.type to force the use of Hikari in a Tomcat-based application, you can now remove that override. Similarly, if you want to stay with the Tomcat connection pool, simply add the following to your configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring.datasource.type=org.apache.tomcat.jdbc.pool.DataSource</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Developer Tools</strong></p>
</div>
<div class="paragraph">
<p>By default, each time your application restarts, a report showing the condition evaluation delta is logged. The report shows the changes to your application’s auto-configuration as you make changes such as adding or removing beans and setting configuration properties.</p>
</div>
<div class="paragraph">
<p>To disable the logging of the report, set the following property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring.devtools.restart.log-condition-evaluation-delta=false</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Kotlin Support</strong></p>
</div>
<div class="paragraph">
<p>We talked earlier in this article about the official support for Kotlin. There is also a dedicated portion of the documentation to Kotlin. </p>
</div>
<div class="paragraph">
<p><strong>JUnit 5</strong></p>
</div>
<div class="paragraph">
<p>As I said earlier the default for a Spring Boot application is to still use JUnit 4. If you want to switch to JUnit 5 you will need to exclude JUnit 4 from the spring boot starter test and add the required dependencies. You will also need to add the plugin listed below. </p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependencies&gt;
	&lt;dependency&gt;
		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
		&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
		&lt;scope&gt;test&lt;/scope&gt;
		&lt;exclusions&gt;
			&lt;exclusion&gt;
				&lt;groupId&gt;junit&lt;/groupId&gt;
				&lt;artifactId&gt;junit&lt;/artifactId&gt;
			&lt;/exclusion&gt;
		&lt;/exclusions&gt;
	&lt;/dependency&gt;
	&lt;dependency&gt;
		&lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;
		&lt;artifactId&gt;junit-jupiter-api&lt;/artifactId&gt;
		&lt;scope&gt;test&lt;/scope&gt;
	&lt;/dependency&gt;
	&lt;dependency&gt;
		&lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;
		&lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;
		&lt;scope&gt;test&lt;/scope&gt;
	&lt;/dependency&gt;
&lt;/dependencies&gt;
&lt;build&gt;
	&lt;plugins&gt;
		&lt;plugin&gt;
			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
			&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
		&lt;/plugin&gt;
		&lt;plugin&gt;
			&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
			&lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
			&lt;dependencies&gt;
				&lt;dependency&gt;
					&lt;groupId&gt;org.junit.platform&lt;/groupId&gt;
					&lt;artifactId&gt;junit-platform-surefire-provider&lt;/artifactId&gt;
					&lt;version&gt;${junit-platform.version}&lt;/version&gt;
				&lt;/dependency&gt;
			&lt;/dependencies&gt;
		&lt;/plugin&gt;
	&lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_spring_boot_2_migration_guide">Spring Boot 2 Migration Guide</h5>
<div class="paragraph">
<p>It probably goes without saying but with any major release like this simply flipping the version number in production isn&#8217;t your best upgrade path. The first thing I would do is read through the Spring Boot 2.0 Migration Guide. For me I found most of my issues revolved around the simplified security model changes and property changes. The migration guide includes an awesome tip for migrating your property files. </p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>With Spring Boot 2.0, many configuration properties were renamed/removed and developers need to update their application.properties/application.yml accordingly. To help you with that, Spring Boot ships a new spring-boot-properties-migrator module. Once added as a dependency to your project, this will not only analyze your application’s environment and print diagnostics at startup, but also temporarily migrate properties at runtime for you. This is a must have during your application migration:</p>
</div>
</blockquote>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-properties-migrator&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>I am not sure what your thoughts are on this but I would certainly start playing with Spring Boot 2 and working on migrating your code over to it but with any major release, I usually wait until the next point release. This isn&#8217;t just for Spring, I do this with pretty much everything from Apple to Pivotal to Angry Birds! </p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pexels-photo-860379.jpeg" alt="pexels photo 860379">
</div>
</div>
<div class="paragraph">
<p>This document was created from <a href="http://therealdanvega.com/blog/2018/03/01/what-is-new-spring-boot-2">this blog post</a>.
You can also watch a video of me talking about <a href="https://youtu.be/91n6y-T-PC8">this post here</a>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_github">Github</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_repositories">Repositories</h3>
<div class="sect3">
<h4 id="_main_repo">Main Repo</h4>
<div class="paragraph">
<p>This is a reddit clone built using Spring Boot 2. I created this project to show off all the cool features of Spring Boot 2.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/cfaddict/springit" class="bare">https://github.com/cfaddict/springit</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ui_templates">UI Templates</h4>
<div class="paragraph">
<p>These are the HTML templates that we are using to build out UI for this course. I wanted to provide the raw templates before we start
introducing Thymleaf into the equation.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/cfaddict/springit-templates" class="bare">https://github.com/cfaddict/springit-templates</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_learning">Learning</h3>
<div class="paragraph">
<p>This is a collection of websites, training videos and resources to help you learn Git &amp; Github. While this course isn&#8217;t
specifically about Git or Github I think it is an important skill to learn. If you have some time please consider
going through some of the links below.</p>
</div>
<div class="paragraph">
<p>Websites</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://git-scm.com/">Git</a></p>
</li>
<li>
<p><a href="https://github.com">Github</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Resources</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.youtube.com/playlist?list=PL0lo9MOBetEHhfG9vJzVCTiDYcbhAiEqL">Github &amp; Git Foundations</a></p>
</li>
<li>
<p><a href="https://help.github.com/articles/git-and-github-learning-resources/">Github Learning Resources</a></p>
</li>
<li>
<p><a href="https://guides.github.com/introduction/flow/">Understanding Github Workflows</a></p>
</li>
<li>
<p><a href="https://guides.github.com/features/mastering-markdown">Mastering Markdown</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=EwWZbyjDs9c">Github Review - Exploring Workflows</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_using_git_github">Using Git &amp; Github</h3>
<div class="paragraph">
<p>If you&#8217;re brand new to Git &amp; Github please don&#8217;t let that throw you off of this course. I have left you with some resources to learn these tools but
they are not a requirement for you to learn about what is new in Spring Boot 2. I also don&#8217;t want you to get discouraged if you are not an IntelliJ user. There is nothing I showed in this section that you couldn&#8217;t do from your IDE or editor of choice. I just happen to be using IntelliJ so I wanted
to show off the tools available within the IDE.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_spring_boot_essentials">Spring Boot Essentials</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_actuator">Actuator</h3>
<div class="listingblock">
<div class="title">Actuator Dependency</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Actuator Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties"># open up all of the endpoints for demo purposes
# only expose certain endpoints ["health","info"]
management.endpoints.web.expose=*
management.endpoints.web.exclude=env
management.endpoint.health.show-details=true</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_building_springit">Building Springit</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section of the documentation is going to contain details about each section of the course as we begin to build out our Reddit clone. In
each of these sections I will provide information, code or even links to topics that we discuss as we start to develop our application. Each
section underneath Building Springit represents a section in the course from here on out. So if you&#8217;re working on the Service Layer section,
click on the Service Layer sub section here to find all of the accompanying documentation.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
MVC stands for Model View Controller
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_spring_mvc_model">Spring MVC: Model</h3>
<div class="imageblock">
<div class="content">
<img src="images/mvc.png" alt="mvc">
</div>
</div>
<div class="paragraph">
<p>In the project overview section we discussed the domain model. For reference I have included our basic model diagram
below. Please remember that this is probably going to change as we begin to build out our application but this should
give us what we need to get started.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/domain_model.png" alt="domain model">
</div>
</div>
<div class="paragraph">
<p>Now that we know what we need to build, how are we going to build it?</p>
</div>
<div class="sect3">
<h4 id="_jpa">JPA</h4>
<div class="paragraph">
<p>The Java Persistence API (JPA) is a Java application programming interface specification that describes the management of relational data in applications using Java Platform, Standard Edition and Java Platform, Enterprise Edition.</p>
</div>
<div class="paragraph">
<p>Persistence in this context covers three areas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The API itself, defined in the <a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/package-summary.html">javax.persistence</a> package</p>
</li>
<li>
<p>The Java Persistence Query Language (JPQL)</p>
</li>
<li>
<p>object/relational metadata</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Class &#8658; Database Table<br>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>JPA is just the specification and by itself isn&#8217;t all that usefull. What you need is a JPA provider that implements the specification. A couple of the most popular implementations are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hibernate</p>
</li>
<li>
<p>Eclipse Link</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_spring_data">Spring Data</h4>
<div class="paragraph">
<p>Spring Data’s mission is to provide a familiar and consistent, Spring-based programming model for data access while still retaining the special traits of the underlying data store.</p>
</div>
<div class="paragraph">
<p><a href="https://projects.spring.io/spring-data/">Spring Data</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_spring_data_jpa">Spring Data JPA</h4>
<div class="paragraph">
<p><a href="https://projects.spring.io/spring-data-jpa/">Spring Data JPA</a></p>
</div>
<div class="paragraph">
<p>Implementing a data access layer of an application has been cumbersome for quite a while. Too much boilerplate code has to be written to execute simple queries as well as perform pagination, and auditing. Spring Data JPA aims to significantly improve the implementation of data access layers by reducing the effort to the amount that’s actually needed. As a developer you write your repository interfaces, including custom finder methods, and Spring will provide the implementation automatically.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Spring Data JPA uses Hibernate under the hood. Through a Spring Boot Starter and Auto Configuration you don&#8217;t have to do much to get Hibernate setup. This is huge because this is one of the things that deters people from starting with Hibernate in the first place.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Spring Data JPA Dependencies</strong></p>
</div>
<div class="paragraph">
<p>You can select Spring Data JPA as one of the options using the Spring Initializr or by adding the following dependency to your pom.xml</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
What dependencies does the spring-boot-starter-data-jpa include?
</td>
</tr>
</table>
</div>
<hr>
</div>
<div class="sect3">
<h4 id="_entities">Entities</h4>
<div class="paragraph">
<p>Now that we know a little bit about Spring Data it&#8217;s time we start to create our entities. Before we do so this is a good time
to create a new branch to work on our new feature.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>git checkout -b spring-mvc-model</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Link Entity</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;

@Entity
public class Link {

    @Id
    @GeneratedValue
    private Long id;
    private String title;
    private String url;

    // comments
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Comment Entity</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;

@Entity
public class Comment {

    @Id
    @GeneratedValue
    private Long id;
    private String body;

    //private Link link;

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Vote Stub (We will come back to this later)</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Vote {

    @Id @GeneratedValue
    private Long id;
    private User user;
    private Link link;
    private int vote;

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Just a few things to point out about our entities</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You will need a public no arg constructor.</p>
</li>
<li>
<p>You will need getters and setters for your properties.</p>
</li>
<li>
<p>You will need a toString method for you entity.</p>
</li>
<li>
<p>You will want an equals and hash code method to check for equality.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Common Entity Annotations</strong></p>
</div>
<div class="paragraph">
<p>When working with Entities these are some of the more common annotations you will be using to provide metadata about your objects.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/Entity.html">@Entity</a></p>
</li>
<li>
<p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/Table.html">@Table</a></p>
</li>
<li>
<p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/Id.html">@Id</a></p>
</li>
<li>
<p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/GeneratedValue.html">@GeneratedValue</a></p>
</li>
<li>
<p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/Column.html">@Column</a></p>
</li>
<li>
<p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/Transient.html">@Transient</a></p>
</li>
<li>
<p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/OrderBy.html">@OrderBy</a></p>
</li>
<li>
<p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/Version.html">@Version</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_project_lombok">Project Lombok</h4>
<div class="paragraph">
<p>Project Lombok is a java library that automatically plugs into your editor and build tools, spicing up your java.
Never write another getter or equals method again.</p>
</div>
<div class="paragraph">
<p><a href="https://projectlombok.org/">Project Lombok</a></p>
</div>
<div class="paragraph">
<p>The Lombok website has installation instructions for whatever IDE you are using. It isn&#8217;t enough to just install
the dependency, you must follow the instructions for your IDE.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/lombok_install.png" alt="lombok install">
</div>
</div>
<div class="paragraph">
<p><a href="https://projectlombok.org/setup/intellij">IntelliJ Installation</a></p>
</div>
<div class="paragraph">
<p>If you can&#8217;t get the Lombok plugin to work in IntelliJ you will need to make sure annotation processing is turned on for your project.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/lombok_annotation_processing.png" alt="lombok annotation processing">
</div>
</div>
<div class="listingblock">
<div class="title">Lombok Dependency</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
    &lt;artifactId&gt;lombok&lt;/artifactId&gt;
    &lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_repositories_2">Repositories</h4>
<div class="paragraph">
<p>The central interface in the Spring Data repository abstraction is <a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/repository/Repository.html">Repository</a>. It takes the domain class to manage as well as the ID type of the domain class as type arguments. This interface acts primarily as a marker interface to capture the types to work with and to help you to discover interfaces that extend this one.</p>
</div>
<div class="listingblock">
<div class="title">LinkRepository.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import com.vega.springit.domain.Link;
import org.springframework.data.jpa.repository.JpaRepository;

public interface LinkRepository extends JpaRepository&lt;Link,Long&gt; {

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">CommentRepository.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface CommentRepository extends JpaRepository&lt;Comment,Long&gt; {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Repository Intefaces</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/repository/CrudRepository.html">CrudRepository</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/repository/PagingAndSortingRepository.html?is-external=true">PagingAndSortingRepository</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-data/jpa/docs/current/api/org/springframework/data/jpa/repository/JpaRepository.html">JpaRepository</a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Data also provides persistence technology-specific abstractions, such as JpaRepository or MongoRepository. Those interfaces extend CrudRepository and expose the capabilities of the underlying persistence technology in addition to the rather generic persistence technology-agnostic interfaces such as CrudRepository.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Custom Queries</strong></p>
</div>
<div class="paragraph">
<p>Extending one of those repositories will give us a lot of functionality out of the box and is usually enough to get started. When you start building out your application you will undoubtedly need more queries than the base repositories give you. We have a couple ways that we can define our custom queries and we will go over them below.</p>
</div>
<div class="paragraph">
<p><strong>Named Queries</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Entity
@NamedQuery(name = "User.findByEmailAddress",query = "select u from User u where u.emailAddress = ?1")
public class User {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Query Methods</strong></p>
</div>
<div class="paragraph">
<p>Using named queries to declare queries for entities is a valid approach and works fine for a small number of queries. As the queries themselves are tied to the Java method that executes them, you can actually bind them directly by using the Spring Data JPA @Query annotation rather than annotating them to the domain class. This frees the domain class from persistence specific information and co-locates the query to the repository interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface UserRepository extends JpaRepository&lt;User, Long&gt; {

  @Query("select u from User u where u.emailAddress = ?1")
  User findByEmailAddress(String emailAddress);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The previous example used JPQL. The @Query annotation allows for running native queries by setting the nativeQuery flag to true, as shown in the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface UserRepository extends JpaRepository&lt;User, Long&gt; {

  @Query(value = "SELECT * FROM USERS WHERE EMAIL_ADDRESS = ?1", nativeQuery = true)
  User findByEmailAddress(String emailAddress);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The JPA module supports defining a query manually as a String or having it being derived from the method name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface UserRepository extends Repository&lt;User, Long&gt; {

  List&lt;User&gt; findByEmailAddressAndLastname(String emailAddress, String lastname);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#jpa.query-methods" class="bare">https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#jpa.query-methods</a></p>
</div>
<div class="paragraph">
<p>We will see more of this as we go throughout the course and as we need custom queries.</p>
</div>
<hr>
</div>
<div class="sect3">
<h4 id="_entity_relationships_mappings">Entity Relationships (Mappings)</h4>
<div class="paragraph">
<p>Mappings are a key feature of Hibernate and JPA. They allow us to model the relationships between two tables in your domain objects as properties.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/domain_model.png" alt="domain model">
</div>
</div>
<div class="paragraph">
<p>JPA Mapping Annotations</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/OneToOne.html">OneToOne Annotation</a></p>
</li>
<li>
<p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/OneToMany.html">OneToMany Annotation</a></p>
</li>
<li>
<p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/ManyToOne.html">ManyToOne Annotation</a></p>
</li>
<li>
<p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/ManyToMany.html">ManyToMany Annotation</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Thoughts on Java</strong></p>
</div>
<div class="paragraph">
<p>This is a really great article from Thorben Janssen on asoociation mappings in Hibernate. If you&#8217;re going to start working with JPA and Hibernate his website <a href="https://www.thoughts-on-java.org">Thoughts on Java</a> is a must bookmark.</p>
</div>
<div class="paragraph">
<p><a href="https://www.thoughts-on-java.org/ultimate-guide-association-mappings-jpa-hibernate/">Ultimate Guide – Association Mappings with JPA and Hibernate</a></p>
</div>
<div class="paragraph">
<p>When we create a bi-directional mapping we have a decision to make. What type should the collection be, a list or a set. This is something to think about and I have included another great article from Thorben on the subject.</p>
</div>
<div class="paragraph">
<p><a href="https://www.thoughts-on-java.org/association-mappings-bag-list-set/">Bag vs Set vs List</a></p>
</div>
<div class="paragraph">
<p>Hibernate Tips Book on Amazon</p>
</div>
<div class="paragraph">
<p><a href="https://www.amazon.com/Hibernate-Tips-solutions-common-problems-ebook/dp/B06XXGYZHS/ref=sr_1_1?tag=toj04-20" class="bare">https://www.amazon.com/Hibernate-Tips-solutions-common-problems-ebook/dp/B06XXGYZHS/ref=sr_1_1?tag=toj04-20</a></p>
</div>
<hr>
</div>
<div class="sect3">
<h4 id="_auditing">Auditing</h4>
<div class="paragraph">
<p>Spring Data provides sophisticated support to transparently keep track of who created or changed an entity and when the change happened. To benefit from that functionality, you have to equip your entity classes with auditing metadata that can be defined either using annotations or by implementing an interface.</p>
</div>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#auditing">Spring Data JPA Auditing</a></p>
</div>
<div class="listingblock">
<div class="title">Auditing Annotations</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@CreatedDate
private LocalDateTime createdDate;

@LastModifiedDate
private LocalDateTime lastUpdatedDate;

@CreatedBy
private String createdBy;

@LastModifiedBy
private String modifiedBy;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The final step is to enable JPA Auditing and to do so we simply need to add the following annotation to a configuration class.</p>
</div>
<div class="listingblock">
<div class="title">How to Enable JPA Auditing</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@SpringBootApplication
@EnableJpaAuditing
public class SpringitApplication {

	private static final Logger log = LoggerFactory.getLogger(SpringitApplication.class);

	public static void main(String[] args) {
		SpringApplication.run(SpringitApplication.class, args);
	}

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the easy approach but at some point we will to log the user that created and modified a record. To do so we
can simply create a configuration class and make our Enable Jpa Auditing aware of the current logged in user.</p>
</div>
<div class="listingblock">
<div class="title">Auditor Aware Configuration</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableJpaAuditing(auditorAwareRef = "auditorAware")
public class JpaConfig {
    @Bean
    public AuditorAware&lt;String&gt; auditorAware() {
        return new AuditorAwareImpl();
    }

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Auditor Aware Implementation</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class AuditorAwareImpl implements AuditorAware&lt;String&gt; {
    @Override
    public Optional&lt;String&gt; getCurrentAuditor() {
        return Optional.of(((User) SecurityContextHolder.getContext().getAuthentication().getPrincipal()).getUsername());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you have a bunch of classes that are going to be auditable you could take this route. Create an abastract class
called Auditable and make it a <a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/MappedSuperclass.html">mapped super class</a>. When your class needs to have these auditable features simply extend this class.</p>
</div>
<div class="listingblock">
<div class="title">Auditable Mapped Super Class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import org.springframework.data.annotation.CreatedBy;
import org.springframework.data.annotation.CreatedDate;
import org.springframework.data.annotation.LastModifiedBy;
import org.springframework.data.annotation.LastModifiedDate;
import org.springframework.data.jpa.domain.support.AuditingEntityListener;

import javax.persistence.EntityListeners;
import javax.persistence.MappedSuperclass;
import java.time.LocalDateTime;

@MappedSuperclass
@EntityListeners(AuditingEntityListener.class)
public abstract class Auditable {

    @CreatedBy
    private String createdBy;

    @CreatedDate
    private LocalDateTime creationDate;

    @LastModifiedBy
    private String lastModifiedBy;

    @LastModifiedDate
    private LocalDateTime lastModifiedDate;

    public String getCreatedBy() {
        return createdBy;
    }

    public void setCreatedBy(String createdBy) {
        this.createdBy = createdBy;
    }

    public LocalDateTime getCreationDate() {
        return creationDate;
    }

    public void setCreationDate(LocalDateTime creationDate) {
        this.creationDate = creationDate;
    }

    public String getLastModifiedBy() {
        return lastModifiedBy;
    }

    public void setLastModifiedBy(String lastModifiedBy) {
        this.lastModifiedBy = lastModifiedBy;
    }

    public LocalDateTime getLastModifiedDate() {
        return lastModifiedDate;
    }

    public void setLastModifiedDate(LocalDateTime lastModifiedDate) {
        this.lastModifiedDate = lastModifiedDate;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Entity
public class Link extends Auditable { }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_database_layer">Database Layer</h3>
<div class="paragraph">
<p>In the last section we took a look at how we build out our entities and repositories. We also learned that our entities map directly to a database table. The question that remains is where is this database located? Is it being created for us or is this up to us? We are going
to answer these questions and more in this section.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Database Configuration</p>
<div class="ulist">
<ul>
<li>
<p>Common Database Properties</p>
</li>
<li>
<p>H2 vs MySQL</p>
</li>
<li>
<p>SQL Logging</p>
</li>
<li>
<p>Hibernate logging level DEBUG</p>
</li>
</ul>
</div>
</li>
<li>
<p>Database Initialization</p>
<div class="ulist">
<ul>
<li>
<p>Hibernate DDL</p>
</li>
<li>
<p>schema.sql</p>
</li>
<li>
<p>data.sql</p>
</li>
</ul>
</div>
</li>
<li>
<p>CommandLineRunner</p>
</li>
</ul>
</div>
<hr>
<div class="sect3">
<h4 id="_common_application_properties">Common Application Properties</h4>
<div class="paragraph">
<p>If you can&#8217;t always remember what properties can be set in your application.properties there is a really good reference at the link below.</p>
</div>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html" class="bare">https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html</a></p>
</div>
<div class="ulist">
<ul>
<li>
<p>DATASOURCE (DataSourceAutoConfiguration &amp; DataSourceProperties)</p>
</li>
<li>
<p>JPA (JpaBaseConfiguration, HibernateJpaAutoConfiguration)</p>
</li>
<li>
<p>H2 Web Console</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_h2">H2</h4>
<div class="paragraph">
<p>These settings will get us going using H2. Please remember that every time you stop your app you will lose your data, this is just how an in-memory database works.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
	&lt;groupId&gt;com.h2database&lt;/groupId&gt;
	&lt;artifactId&gt;h2&lt;/artifactId&gt;
	&lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

#datasource (default to testdb)
spring.datasource.name=springit
# sa | empty password
#spring.datasource.username=
#spring.datasource.password=

#JPA &amp; Hibernate
#spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=true</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mysql">MySQL</h4>
<div class="paragraph">
<p>In the previous lesson we looked at how to use the H2 in-memory database. That is great for getting started but at some point we will want to move to a production ready database like MySQL. If you are using some other DBMS just do a quick search for what your settings will look like.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
	&lt;groupId&gt;mysql&lt;/groupId&gt;
	&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Unlike H2 we need to at least create the database in MySQL. We don&#8217;t need to create any of the schema yet, but we need an empty database for us to use.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mysql_empty_schema.png" alt="mysql empty schema">
</div>
</div>
<div class="paragraph">
<p>With a schema in place we can setup our MySQL specific datasource properties.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">#DDL mode. This is actually a shortcut for the "hibernate.hbm2ddl.auto"
#property. Defaults to "create-drop" when using an embedded database and no
#schema manager was detected. Otherwise, defaults to "none".
# create | create-drop | none | update | validate
#spring.jpa.hibernate.ddl-auto=


# mysql settings
spring.jpa.hibernate.ddl-auto=create
spring.datasource.url=jdbc:mysql://localhost:3306/springit?useSSL=false
spring.datasource.username=springit
spring.datasource.password=password</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>MySQL Use SSL</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Wed Jul 11 07:15:23 EDT 2018 WARN: Establishing SSL connection without server's identity verification is not recommended. According to MySQL 5.5.45+, 5.6.26+ and 5.7.6+ requirements SSL connection must be established by default if explicit option isn't set. For compliance with existing applications not using SSL the verifyServerCertificate property is set to 'false'. You need either to explicitly disable SSL by setting useSSL=false, or set useSSL=true and provide truststore for server certificate verification.</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mysql_show_tables.png" alt="mysql show tables">
</div>
</div>
<div class="paragraph">
<p>With MySQL (and most other DBMS) you will need to give a user permissions to the database you setup. In our case we created a user called springit in MySQL Workbench and gave it privileges to access the database.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mysql_user_permissions.png" alt="mysql user permissions">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_initialize_a_database">Initialize a database</h4>
<div class="paragraph">
<p>A database can be initialized in different ways depending on what your stack is. Of course, you can also do it manually, provided the database is a separate process.</p>
</div>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/howto-database-initialization.html" class="bare">https://docs.spring.io/spring-boot/docs/current/reference/html/howto-database-initialization.html</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-initialize-a-database-using-spring-jdbc" class="bare">https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-initialize-a-database-using-spring-jdbc</a></p>
</div>
<div class="paragraph">
<p>If you&#8217;re using Spring boot 2, database initialization only works for embedded databases (H2, HSQLDB, &#8230;&#8203;). If you want to use it for other databases as well, you need to change the spring.datasource.initialization-mode property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring.datasource.initialization-mode=always</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also make sure that you are no longer letting Hibernate create and drop the db for you.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring.jpa.hibernate.ddl-auto=none</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you&#8217;re going to create a script for database initialization it can&#8217;t be empty. If you just create the file and run the application you will see an error that looks like this.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.UncategorizedScriptException: Failed to execute database script from resource [URL [file:/Users/vega/dev/spring-boot-2/springit/target/classes/data.sql]]; nested exception is java.lang.IllegalArgumentException: 'script' must not be null or empty
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1710) ~[spring-beans-5.0.4.RELEASE.jar:5.0.4.RELEASE]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_command_line_runner">Command Line Runner</h4>
<div class="paragraph">
<p>A <a href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/CommandLineRunner.html"><code>Command Line Runner</code></a> is an interface that contains a single method. It is because of this single method that it is marked as a Functional Interface and we can therefore implement with a Lambda and can avoid creating a separate class to do so.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">/*
 * Copyright 2012-2017 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.springframework.boot;

import org.springframework.core.Ordered;
import org.springframework.core.annotation.Order;

/**
 * Interface used to indicate that a bean should &lt;em&gt;run&lt;/em&gt; when it is contained within
 * a {@link SpringApplication}. Multiple {@link CommandLineRunner} beans can be defined
 * within the same application context and can be ordered using the {@link Ordered}
 * interface or {@link Order @Order} annotation.
 * &lt;p&gt;
 * If you need access to {@link ApplicationArguments} instead of the raw String array
 * consider using {@link ApplicationRunner}.
 *
 * @author Dave Syer
 * @see ApplicationRunner
 */
@FunctionalInterface
public interface CommandLineRunner {

	/**
	 * Callback used to run the bean.
	 * @param args incoming main method arguments
	 * @throws Exception on error
	 */
	void run(String... args) throws Exception;

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Command Line Runner API:</p>
</div>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/CommandLineRunner.html" class="bare">https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/CommandLineRunner.html</a></p>
</div>
<div class="paragraph">
<p>We could create classes that implement the Command Line Runner if you had the need to do multiple things and or didn&#8217;t want to put a ton of extra code in your main application class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.vega.springit;

import org.springframework.boot.CommandLineRunner;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

@Component
@Order(1)
public class DatabaseLoader implements CommandLineRunner {

    @Override
    public void run(String... args) throws Exception {
        // do some database work
        System.out.println("DatabaseLoader...");
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.vega.springit;

import org.springframework.boot.CommandLineRunner;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

@Component
@Order(2)
public class SomeOtherRunner implements CommandLineRunner {
    @Override
    public void run(String... args) throws Exception {
        // do some other work
        System.out.println("SomeOtherRunner...");
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For this example of just loading a few records though I am going to use my main application class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Bean
CommandLineRunner runner() {
    return args -&gt; {

    };
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We still need to tell Spring about our Command Line Runner to make this work. In the concrete class example we marked it as a component but that won&#8217;t work for us here. The main application is annotated with SpringBootApplication which is made up of @EnableAutoConfiguration which marks this class as a configuration class.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>@Configuration indicates that a class declares one or more @Bean methods and may be processed by the Spring container to generate bean definitions and service requests for those beans at runtime</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Inherited
@SpringBootConfiguration
@EnableAutoConfiguration
@ComponentScan(excludeFilters = {
		@Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),
		@Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) })
public @interface SpringBootApplication { }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Bean
CommandLineRunner runner(LinkRepository linkRepository, CommentRepository commentRepository) {
    return args -&gt; {
        Link link = new Link("Getting Started with Spring Boot 2","https://therealdanvega.com/spring-boot-2");
        linkRepository.save( link );

        Comment comment = new Comment("This Spring Boot 2 Link is awesome",link);
        commentRepository.save(comment);
        link.addComment(comment);

        System.out.println(link.getComments());
    };
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to learn more about the Command Line Runner Interface I wrote up an article on it that you can read below.</p>
</div>
<div class="paragraph">
<p><a href="https://therealdanvega.com/blog/2017/04/07/spring-boot-command-line-runner" class="bare">https://therealdanvega.com/blog/2017/04/07/spring-boot-command-line-runner</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/command_line_runner.png" alt="command line runner">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spring_mvc_controller">Spring MVC: Controller</h3>
<div class="imageblock">
<div class="content">
<img src="images/mvc.png" alt="mvc">
</div>
</div>
<div class="sect3">
<h4 id="_controller_introduction">Controller Introduction</h4>
<div class="paragraph">
<p>We are now into the C in our MVC application. The C stands for controller and you can think of the controller as the traffic cop in our application. The controller handles incoming http requests and "directs traffic". Methods in your controller are mapped to HTTP
by using @RequestingMapping (or one of its composed) annotations.</p>
</div>
<div class="sect4">
<h5 id="_controller_annotation">@Controller Annotation</h5>
<div class="paragraph">
<p>Spring MVC provides an annotation-based programming model where <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/stereotype/Controller.html">@Controller</a> and <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/RestController.html">@RestController</a> components use annotations to express request mappings, request input, exception handling, and more. Annotated controllers have flexible method signatures and do not have to extend base classes nor implement specific interfaces. The following example shows a controller defined by annotations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Controller
public class HelloController {

    @GetMapping("/hello")
    public String handle(Model model) {
        model.addAttribute("message", "Hello World!");
        return "index";
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_controller_component_service_stereo_type_annotations">@Controller,@Component, @Service (Stereo-type annotations)</h5>
<div class="paragraph">
<p>What are all of the annotations I am seeing at the top of classes. I have seen things <code>@Component</code>, <code>@Controller</code>, <code>@RestController</code>, <code>@Service</code> and I just don&#8217;t understand what they are. Luckily I have already written a pretty good article on how these all work. So if you have a chance please read through the following blog post.</p>
</div>
<div class="paragraph">
<p><a href="https://therealdanvega.com/blog/2017/03/27/spring-stereotype-annotations" class="bare">https://therealdanvega.com/blog/2017/03/27/spring-stereotype-annotations</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_componentscan">@ComponentScan</h5>
<div class="paragraph">
<p>By default Spring is going to look in your base package for components. If you want to include controllers(components) outside of your base package you need to use <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/annotation/ComponentScan.html">@ComponentScan</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@SpringBootApplication
@ComponentScan(basePackages = {"com.foo.components"})
public class SpringitApplication {

	private static final Logger log = LoggerFactory.getLogger(SpringitApplication.class);

	public static void main(String[] args) {
		SpringApplication.run(SpringitApplication.class, args);
	}

}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_controller_vs_restcontroller">@Controller vs @RestController</h4>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/RestController.html">@RestController</a> is a composed annotation that is itself meta-annotated with <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/stereotype/Controller.html">@Controller</a> and <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/RequestBody.html">@ResponseBody</a> to indicate a controller whose every method inherits the type-level @ResponseBody annotation and, therefore, writes directly to the response body versus view resolution and rendering with an HTML template.</p>
</div>
<div class="paragraph">
<p>If you create a templates folder under resources with an index.html file containing the following code you can switch <code>@RestController</code> to <code>@Controller</code> and see the it in action.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;
    &lt;title&gt;Springit&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;h1&gt;Welcome to SpringIt!&lt;/h1&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_requestmapping">@RequestMapping</h5>
<div class="paragraph">
<p>You can use the <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/RequestMapping.html">@RequestMapping</a> annotation to map requests to controllers methods. It has various attributes to match by URL, HTTP method, request parameters, headers, and media types. You can use it at the class level to express shared mappings or at the method level to narrow down to a specific endpoint mapping.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RequestMapping( path = "/", method = RequestMethod.GET, consumes = "application/json", produces = "application.json")
public String home(){
    return "Hello, Spring Boot 2!";
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are also HTTP method specific shortcut variants of @RequestMapping:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/GetMapping.html">@GetMapping</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/PostMapping.html">@PostMapping</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/PutMapping.html">@PutMapping</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/DeleteMapping.html">@DeleteMapping</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/PatchMapping.html">@PatchMapping</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_handler_methods">Handler Methods</h5>
<div class="paragraph">
<p>@RequestMapping handler methods have a flexible signature and can choose from a range of supported controller method arguments and return values. I have included a link
to the documentation that covers all of the available handler method arguments.</p>
</div>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html#mvc-ann-methods" class="bare">https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html#mvc-ann-methods</a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_link_controller">Link Controller</h4>
<div class="paragraph">
<p>Now that we know a little bit more about controllers and what methods are available to us we should be able to start building out the basic parts of our Link Controller. Create a new class in the controller package called <code>LinkController.java</code>. We are going to start with some stub methods and discuss a few things about how to start implementing them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestController
public class LinkController {

    // list
    public List&lt;Link&gt; list() {
        return null;
    }

    // CRUD
    public Link create() {
        return null;
    }
    public Link read() {
        return null;
    }
    public Link update() {
        return null;
    }
    public void delete() {

    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spring_mvc_the_view_layer">Spring MVC: The View Layer</h3>
<div class="imageblock">
<div class="content">
<img src="images/mvc.png" alt="mvc">
</div>
</div>
<div class="sect3">
<h4 id="_introduction_to_views">Introduction to views</h4>
<div class="paragraph">
<p>If we were creating a REST service application we wouldn&#8217;t need any view. Instead we are creating a Spring MVC app with a front end using a template engine. As we will see in a bit, we have many choices when it comes to what template engines we can use.</p>
</div>
<div class="sect4">
<h5 id="_static_content">Static Content</h5>
<div class="paragraph">
<p>By default, Spring Boot serves static content from a directory called /static (or /public or /resources or /META-INF/resources) in the classpath or from the root of the ServletContext.</p>
</div>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-spring-mvc-static-content" class="bare">https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-spring-mvc-static-content</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_welcome_page">Welcome Page</h5>
<div class="paragraph">
<p>Spring Boot supports both static and templated welcome pages. It first looks for an index.html file in the configured static content locations. If one is not found, it then looks for an index template. If either is found, it is automatically used as the welcome page of the application.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;
    &lt;title&gt;Springit&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;h1&gt;This is my welcome page&lt;/h1&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_custom_favicon">Custom Favicon</h6>
<div class="paragraph">
<p>Spring Boot looks for a favicon.ico in the configured static content locations and the root of the classpath (in that order). If such a file is present, it is automatically used as the favicon of the application.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_templates">Templates</h4>
<div class="paragraph">
<p>Now that we know how to serve static content we need to understand how to serve dynamic content. This is where templates come into play and lucky for us Spring MVC supports a variety of template engines.</p>
</div>
<div class="sect4">
<h5 id="_view_resolvers">View Resolvers</h5>
<div class="paragraph">
<p>Before we dive into the different template engines we need to understand how templates work behind the scenes. It&#8217;s important to undstand that there is magic going on here. The reason I say this is because if you were creating a Spring MVC application from scratch a view resolver is something you would have to manually configured.</p>
</div>
<div class="paragraph">
<p>A <a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-customize-view-resolvers">ViewResolver</a> is a core component of Spring MVC, translating view names in @Controller to actual View implementations.</p>
</div>
</div>
<div class="sect4">
<h5 id="_template_engines">Template Engines</h5>
<div class="paragraph">
<p>As well as REST web services, you can also use Spring MVC to serve dynamic HTML content. Spring MVC supports a variety of templating technologies, including Thymeleaf, FreeMarker, and JSPs. Also, many other templating engines include their own Spring MVC integrations.</p>
</div>
<div class="paragraph">
<p>Spring Boot includes auto-configuration support for the following templating engines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FreeMarker</p>
</li>
<li>
<p>Groovy</p>
</li>
<li>
<p>Thymeleaf</p>
</li>
<li>
<p>Mustache</p>
</li>
</ul>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
If possible, JSPs should be avoided. There are several known limitations when using them with embedded servlet containers.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_getting_started_with_thymeleaf">Getting Started with Thymeleaf</h5>
<div class="paragraph">
<p>To get started with <a href="https://www.thymeleaf.org/">Thymeleaf</a> you need to select it when you are creating your project</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/thymeleaf_dependency.png" alt="thymeleaf dependency">
</div>
</div>
<div class="paragraph">
<p>OR add the dependency to your project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_what_is_thymeleaf">What is Thymeleaf</h5>
<div class="paragraph">
<p><a href="https://www.thymeleaf.org/">Thymeleaf</a> is a modern server-side Java template engine for both web and standalone environments.</p>
</div>
<div class="paragraph">
<p>Thymeleaf&#8217;s main goal is to bring elegant natural templates to your development workflow — HTML that can be correctly displayed in browsers and also work as static prototypes, allowing for stronger collaboration in development teams.</p>
</div>
</div>
<div class="sect4">
<h5 id="_natural_templates">Natural Templates</h5>
<div class="paragraph">
<p>HTML templates written in Thymeleaf still look and work like HTML, letting the actual templates that are run in your application keep working as useful design artifacts.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th th:text="#{msgs.headers.name}"&gt;Name&lt;/th&gt;
      &lt;th th:text="#{msgs.headers.price}"&gt;Price&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr th:each="prod: ${allProducts}"&gt;
      &lt;td th:text="${prod.name}"&gt;Oranges&lt;/td&gt;
      &lt;td th:text="${#numbers.formatDecimal(prod.price, 1, 2)}"&gt;0.99&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_hello_thymeleaf">Hello, Thymeleaf!</h4>
<div class="paragraph">
<p>Now that we know what template engines are in Spring Boot and we have selected Thymeleaf its time we give a quick test run. In our templates folder add a new file called <code>home.html</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" &gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;
    &lt;title&gt;Springit&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;h1&gt;Default Welcome Message&lt;/h1&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we are going to add an attribute called title to our model that will be returned to our view for us.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Controller
public class HomeController {

    @GetMapping("/home")
    public String home(Model model) {
        model.addAttribute("title","Hello, Thymeleaf!");
        return "home";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Remember that Thymeleaf is a natural template engine that allows us to use valid HTML. If we wanted to display our title we can use a data attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;h1 data-th-text="${title}"&gt;Default Welcome Message&lt;/h1&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This works but it also gets pretty verbose. If we add a namespace to our html file we can use a shorthand.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now instead of the data attribute we can just use th:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;h1 th:text="${title}"&gt;Default Welcome Message&lt;/h1&gt;</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_thymeleaf_standard_dialects">Thymeleaf Standard Dialects</h5>
<div class="paragraph">
<p>The first thing you will notice is that this file is HTML5 that can be correctly displayed by any browser because it does not include any non-HTML tags (browsers ignore all attributes they don’t understand, like th:text).</p>
</div>
<div class="paragraph">
<p><a href="https://www.thymeleaf.org/doc/articles/standarddialect5minutes.html" class="bare">https://www.thymeleaf.org/doc/articles/standarddialect5minutes.html</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_template_reloading">Template Reloading</h5>
<div class="paragraph">
<p>If you use Thymeleaf, set spring.thymeleaf.cache to false. See ThymeleafAutoConfiguration for other Thymeleaf customization options.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_springit_templates">SpringIt Templates</h4>
<div class="paragraph">
<p>I mentioned these towards the beginning of the course and it&#8217;s finally time to use them. If you missed it earlier I created these so we wouldn&#8217;t have to waste time designing some basic templates. The point of this course is to teach you all about Spring Boot, not design. If you haven&#8217;t already downloaded them please do so now.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/cfaddict/springit-templates" class="bare">https://github.com/cfaddict/springit-templates</a></p>
</div>
<div class="paragraph">
<p>We are going to copy all of the templates over to our static folder.</p>
</div>
<div class="sect4">
<h5 id="_what_we_are_working_on">What we are working on</h5>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Before we get started just a couple of notes before we get started with building out our templates.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>We are going to leave the voting mechanism (up vote/down vote) for a later section</p>
</li>
<li>
<p>Because we haven&#8217;t talked about Security yet we aren&#8217;t going to work on any of the following in this section</p>
<div class="ulist">
<ul>
<li>
<p>Login / Logout</p>
</li>
<li>
<p>Register / Account</p>
</li>
<li>
<p>username of who submitted the link</p>
</li>
<li>
<p>Add Comment</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_thymeleaf_layouts">Thymeleaf Layouts</h4>
<div class="paragraph">
<p>In our templates, we will often want to include parts from other templates, parts like footers, headers, menus…</p>
</div>
<div class="paragraph">
<p>In order to do this, Thymeleaf needs us to define these parts, “fragments”, for inclusion, which can be done using the th:fragment attribute.</p>
</div>
<div class="paragraph">
<p>Say we want to add a head tag to all of our pages pages, we can do so by creating a fragment called head.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head th:fragment="head"&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"&gt;
    &lt;meta name="description" content=""&gt;
    &lt;meta name="author" content=""&gt;
    &lt;title&gt;Springit - Spring Boot Reddit Clone&lt;/title&gt;
    &lt;!-- Bootstrap core CSS --&gt;
    &lt;link rel="stylesheet" th:href="@{/libs/bootstrap/css/bootstrap.min.css}"/&gt;
    &lt;!-- Custom styles for this template --&gt;
    &lt;link rel="stylesheet" th:href="@{/css/springit.css}"&gt;
    &lt;!-- Google Fonts --&gt;
    &lt;link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oswald|Roboto" &gt;
    &lt;!-- Font Awesome (for icons) --&gt;
    &lt;script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>But what if we wanted any page using this layout to pass in its own title. No problem, we can use variables in our fragments as well.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head th:fragment="head(title)"&gt;
    &lt;title th:text="${title}"&gt;Springit - Spring Boot Reddit Clone&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>And then in a page using the head fragment we could do this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head th:replace="~{layouts/main_layout :: head(title = 'My Unique Title Goes here!')}"&gt;
&lt;/head&gt;
&lt;body&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is a bunch we can do with this template approach. I would encourage you to read up on it before we moved forward.</p>
</div>
<div class="paragraph">
<p><a href="https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#template-layout" class="bare">https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#template-layout</a></p>
</div>
<div class="paragraph">
<p>We are going to build a layout page that our templates can use. Create a new folder under templates called layouts and create a main_layout.html.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head th:fragment="head(title)"&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"&gt;
    &lt;meta name="description" content=""&gt;
    &lt;meta name="author" content=""&gt;
    &lt;title th:text="${title}"&gt;Springit - Spring Boot Reddit Clone&lt;/title&gt;
    &lt;!-- Bootstrap core CSS --&gt;
    &lt;link rel="stylesheet" th:href="@{/libs/bootstrap/css/bootstrap.min.css}"/&gt;
    &lt;!-- Custom styles for this template --&gt;
    &lt;link rel="stylesheet" th:href="@{/css/springit.css}"&gt;
    &lt;!-- Google Fonts --&gt;
    &lt;link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oswald|Roboto" &gt;
    &lt;!-- Font Awesome (for icons) --&gt;
    &lt;script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;!-- Navigation --&gt;
    &lt;nav class="navbar navbar-expand-lg navbar-dark bg-spring fixed-top" th:fragment="navigation"&gt;
        &lt;div class="container"&gt;
            &lt;a class="navbar-brand" href="/"&gt;
                &lt;i class="fa fa-leaf" aria-hidden="true"&gt;&lt;/i&gt;
                SPRINGIT
            &lt;/a&gt;
            &lt;button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive"
                    aria-expanded="false" aria-label="Toggle navigation"&gt;
                &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;
            &lt;/button&gt;
            &lt;div class="collapse navbar-collapse" id="navbarResponsive"&gt;
                &lt;ul class="navbar-nav ml-auto"&gt;
                    &lt;li class="nav-item active"&gt;
                        &lt;a class="nav-link" href="/"&gt;
                            &lt;i class="fas fa-home" aria-hidden="true"&gt;&lt;/i&gt; Home
                        &lt;/a&gt;
                    &lt;/li&gt;

                    &lt;!-- if user is signed in --&gt;
                    &lt;li class="nav-item"&gt;
                        &lt;a class="nav-link" th:href="@{/link/submit}"&gt;
                            &lt;i class="fa fa-link" aria-hidden="true"&gt;&lt;/i&gt; Submit Link&lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li class="nav-item"&gt;
                        &lt;a class="nav-link" href="../auth/profile.html"&gt;
                            &lt;i class="fa fa-user" aria-hidden="true"&gt;&lt;/i&gt; Account&lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li class="nav-item"&gt;
                        &lt;a class="nav-link" href="#"&gt;
                            &lt;i class="fa fa-sign-out-alt" aria-hidden="true"&gt;&lt;/i&gt; Sign Out&lt;/a&gt;
                    &lt;/li&gt;

                    &lt;!-- if user is not signed in --&gt;
                    &lt;li class="nav-item"&gt;
                        &lt;a class="nav-link" href=../auth/login.html&gt;
                            &lt;i class="fa fa-sign-in-alt" aria-hidden="true"&gt;&lt;/i&gt; Sign In&lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li class="nav-item"&gt;
                        &lt;a class="nav-link" href="../auth/register.html"&gt;
                            &lt;i class="fa fa-user-plus" aria-hidden="true"&gt;&lt;/i&gt; Register&lt;/a&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/nav&gt;

    &lt;div class="jumbotron jumbotron-fluid" th:fragment="jumbotron"&gt;
        &lt;div class="container" align="center"&gt;
            &lt;h2 class="display-4"&gt;Spring Boot Reddit Clone&lt;/h2&gt;
            &lt;p class="lead"&gt;This is a reddit clone built using &lt;a href="#"&gt;Spring Boot 2&lt;/a&gt;, &lt;a href="#"&gt;&lt;/a&gt;Spring Framework 5&lt;/a&gt; &amp; so many other great projects! If you would like to learn how to build this
                application you can check out my course, &lt;a href="#"&gt;Getting Started with Spring Boot 2&lt;/a&gt;.&lt;/p&gt;
            &lt;a href="http://www.github.com/cfaddict/springit" class="btn btn-success" target="_blank"&gt;&lt;i class="fab fa-github"&gt;&lt;/i&gt;  Github Repo&lt;/a&gt;
            &lt;a href="https://therealdanvega.teachable.com/p/spring-boot-2" class="btn btn-success" target="_blank"&gt;&lt;i class="fas fa-graduation-cap"&gt;&lt;/i&gt; Spring Boot 2 Course&lt;/a&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="container" th:fragment="content"&gt;
        &lt;p&gt;This is your main content&lt;/p&gt;
    &lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>I like to create a new file in this folder as well called new_page.html. This is what a basic starter page will look like.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head th:replace="~{layouts/main_layout :: head(title = 'Springit - Spring Boot Reddit Clone')}"&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;nav th:replace="~{layouts/main_layout :: nav}"&gt;&lt;/nav&gt;
&lt;div th:replace="~{layouts/main_layout :: jumbotron}"&gt;&lt;/div&gt;
&lt;div th:replace="~{layouts/main_layout :: content}"&gt;
    &lt;p&gt;This is my content&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_building_our_link_list_page">Building our Link List Page</h4>
<div class="paragraph">
<p>Now that we have our layout it&#8217;s time to build our first page, our list of links. Before we get started it would be a good idea to have a list of links in our database. I went over to one of my favorite sub reddits <a href="https://www.reddit.com/r/springboot">/r/springboot</a> and just grabbed 11 items for testing.</p>
</div>
<div class="paragraph">
<p>To do so I am going to move them into our database loader and remove the bean from the main application class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Component
public class DatabaseLoader implements CommandLineRunner {

    private LinkRepository linkRepository;
    private CommentRepository commentRepository;

    public DatabaseLoader(LinkRepository linkRepository, CommentRepository commentRepository) {
        this.linkRepository = linkRepository;
        this.commentRepository = commentRepository;
    }

    @Override
    public void run(String... args) {
        Map&lt;String,String&gt; links = new HashMap&lt;&gt;();
        links.put("Securing Spring Boot APIs and SPAs with OAuth 2.0","https://auth0.com/blog/securing-spring-boot-apis-and-spas-with-oauth2/?utm_source=reddit&amp;utm_medium=sc&amp;utm_campaign=springboot_spa_securing");
        links.put("Easy way to detect Device in Java Web Application using Spring Mobile - Source code to download from GitHub","https://www.opencodez.com/java/device-detection-using-spring-mobile.htm");
        links.put("Tutorial series about building microservices with SpringBoot (with Netflix OSS)","https://medium.com/@marcus.eisele/implementing-a-microservice-architecture-with-spring-boot-intro-cdb6ad16806c");
        links.put("Detailed steps to send encrypted email using Java / Spring Boot - Source code to download from GitHub","https://www.opencodez.com/java/send-encrypted-email-using-java.htm");
        links.put("Build a Secure Progressive Web App With Spring Boot and React","https://dzone.com/articles/build-a-secure-progressive-web-app-with-spring-boo");
        links.put("Building Your First Spring Boot Web Application - DZone Java","https://dzone.com/articles/building-your-first-spring-boot-web-application-ex");
        links.put("Building Microservices with Spring Boot Fat (Uber) Jar","https://jelastic.com/blog/building-microservices-with-spring-boot-fat-uber-jar/");
        links.put("Spring Cloud GCP 1.0 Released","https://cloud.google.com/blog/products/gcp/calling-java-developers-spring-cloud-gcp-1-0-is-now-generally-available");
        links.put("Simplest way to Upload and Download Files in Java with Spring Boot - Code to download from Github","https://www.opencodez.com/uncategorized/file-upload-and-download-in-java-spring-boot.htm");
        links.put("Add Social Login to Your Spring Boot 2.0 app","https://developer.okta.com/blog/2018/07/24/social-spring-boot");
        links.put("File download example using Spring REST Controller","https://www.jeejava.com/file-download-example-using-spring-rest-controller/");

        links.forEach((k,v) -&gt; {
            linkRepository.save(new Link(k,v));
            // we will do something with comments later
        });

        long linkCount = linkRepository.count();
        System.out.println("Number of links in the database: " + linkCount );
    }
}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_pretty_time">Pretty Time</h5>
<div class="paragraph">
<p>When we display time I don&#8217;t want to just display the creation date. I want to display something like</p>
</div>
<div class="ulist">
<ul>
<li>
<p>moments ago</p>
</li>
<li>
<p>10 minutes ago</p>
</li>
<li>
<p>1 hour ago</p>
</li>
<li>
<p>7 hours ago</p>
</li>
<li>
<p>1 day ago</p>
</li>
<li>
<p>10 days ago</p>
</li>
<li>
<p>1 year ago</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To accomplish this we are going to include a neat little library called <a href="http://www.ocpsoft.org/prettytime/">Pretty Time</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.ocpsoft.prettytime&lt;/groupId&gt;
    &lt;artifactId&gt;prettytime&lt;/artifactId&gt;
    &lt;version&gt;4.0.1.Final&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_link_domain_class">Link Domain Class</h6>
<div class="paragraph">
<p>These are a few helper methods if you get stuck.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public String getDomainName() throws URISyntaxException {
    URI uri = new URI(this.url);
    String domain = uri.getHost();
    return domain.startsWith("www.") ? domain.substring(4) : domain;
}

public String getPrettyTime() {
    PrettyTime pt = BeanUtil.getBean(PrettyTime.class);
    return pt.format(convertToDateViaInstant(getCreationDate()));
}

private Date convertToDateViaInstant(LocalDateTime dateToConvert) {
    return java.util.Date.from(dateToConvert.atZone(ZoneId.systemDefault()).toInstant());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Autowiring Beans into classes not managed by Spring</p>
</div>
<div class="paragraph">
<p><a href="https://dzone.com/articles/autowiring-spring-beans-into-classes-not-managed-by-spring" class="bare">https://dzone.com/articles/autowiring-spring-beans-into-classes-not-managed-by-spring</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.vega.springit.service;

import org.springframework.beans.BeansException;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationContextAware;
import org.springframework.stereotype.Service;

@Service
public class BeanUtil implements ApplicationContextAware {

    private static ApplicationContext context;

    @Override
    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {
        context = applicationContext;
    }

    public static &lt;T&gt; T getBean(Class&lt;T&gt; beanClass) {
        return context.getBean(beanClass);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is what our link list page should look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head th:replace="~{layouts/main_layout :: head(title='Springit - Spring Boot Reddit Clone')}"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;nav th:replace="~{layouts/main_layout :: nav}"&gt;&lt;/nav&gt;
    &lt;div th:replace="~{layouts/main_layout :: jumbotron}"&gt;&lt;/div&gt;

    &lt;div class="container" th:fragment="content"&gt;

        &lt;!-- links --&gt;
        &lt;div class="row link" th:each="link : ${links}"&gt;
            &lt;div class="col-1"&gt;
                &lt;div&gt;&lt;a href="#" class="upvote"&gt;&lt;i class="fas fa-arrow-up"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/div&gt;
                &lt;div&gt;&lt;span class="votecount"&gt;3&lt;/span&gt;&lt;/div&gt;
                &lt;div&gt;&lt;a href="#" class="downvote"&gt;&lt;i class="fas fa-arrow-down"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="col-11"&gt;
                &lt;p class="title"&gt;
                    &lt;a class="title " th:href="@{'/link/' + ${link.id}}" th:text="${link.title}"&gt;
                        Title Goes Here
                    &lt;/a&gt;
                    &lt;span class="domain"&gt;(&lt;a th:href="${link.url}" th:text="${link.getDomainName()}"&gt;therealdanvega.com&lt;/a&gt;)&lt;/span&gt;
                &lt;/p&gt;
                &lt;p class="tagline "&gt;submitted
                    &lt;!--&lt;time title="Sat Mar 10 06:26:36 2018 UTC" datetime="2018-03-10T06:26:36+00:00" class="live-timestamp"&gt;2 hours ago&lt;/time&gt; by--&gt;
                    &lt;time th:title="${link.getCreationDate()}" th:datetime="${link.getCreationDate()}" class="live-timestamp" th:text="${link.getPrettyTime()}"&gt;1 hour(s)&lt;/time&gt; by
                    &lt;a href="/" class="author"&gt;therealdanvega&lt;/a&gt;
                &lt;/p&gt;
                &lt;p&gt;
                    &lt;a th:href="@{'/link/' + ${link.id} + '#comments'}" class="comments" th:text="|${link.getComments().size()} comments|"&gt;&lt;i class="fas fa-comments"&gt;&lt;/i&gt; 0 comments&lt;/a&gt;
                    &lt;a href="/" class="share"&gt;&lt;i class="fas fa-share-square"&gt;&lt;/i&gt; share&lt;/a&gt;
                &lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;

    &lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_building_our_link_view_page">Building our Link View Page</h4>
<div class="paragraph">
<p>We already have a working list page and now we need to create a vew page for each link. We will start out by creating a new <code>@GetMapping</code> in our <code>LinkController</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @GetMapping("/link/{id}")
    public String read(@PathVariable Long id, Model model) {
        return "link/view";
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>And we will create a new view page. I did this by renaming link to view and using our layout fragments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head th:replace="~{layouts/main_layout :: head(title = 'Springit - Spring Boot Reddit Clone')}"&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;nav th:replace="~{layouts/main_layout :: nav}"&gt;&lt;/nav&gt;
    &lt;div th:replace="~{layouts/main_layout :: jumbotron}"&gt;&lt;/div&gt;

    &lt;div class="container"&gt;

        &lt;!-- link --&gt;
        &lt;div class="row link"&gt;
            &lt;div class="col-1"&gt;
                &lt;div&gt;&lt;a href="#" class="upvote"&gt;&lt;i class="fas fa-arrow-up"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/div&gt;
                &lt;div&gt;&lt;span class="votecount"&gt;3&lt;/span&gt;&lt;/div&gt;
                &lt;div&gt;&lt;a href="#" class="downvote"&gt;&lt;i class="fas fa-arrow-down"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="col-11"&gt;
                &lt;p class="title"&gt;
                    &lt;a class="title " href="http://therealdanvega.com/blog/2018/03/01/what-is-new-spring-boot-2"&gt;
                        What's new in Spring Boot 2?
                    &lt;/a&gt;
                    &lt;span class="domain"&gt;(&lt;a href="http://therealdanvega.com"&gt;therealdanvega.com&lt;/a&gt;)&lt;/span&gt;
                &lt;/p&gt;
                &lt;p class="tagline "&gt;submitted
                    &lt;time title="Sat Mar 10 06:26:36 2018 UTC" datetime="2018-03-10T06:26:36+00:00" class="live-timestamp"&gt;2 hours ago&lt;/time&gt; by
                    &lt;a href="https://www.reddit.com/user/therealdanvega" class="author"&gt;therealdanvega&lt;/a&gt;
                    &lt;span class="userattrs"&gt;&lt;/span&gt;
                &lt;/p&gt;
                &lt;p&gt;
                    &lt;a href="#" class="comments"&gt;&lt;i class="fas fa-comments"&gt;&lt;/i&gt; 8 comments&lt;/a&gt;
                    &lt;a href="#" class="share"&gt;&lt;i class="fas fa-share-square"&gt;&lt;/i&gt; share&lt;/a&gt;
                &lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        &lt;!-- link comments --&gt;
        &lt;div id="comments" class="comments"&gt;
            &lt;div class="row header"&gt;
                &lt;div class="col-1"&gt;&amp;nbsp;&lt;/div&gt;
                &lt;div class="col-11 title"&gt;
                    all 21 comments
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="row addcomment"&gt;
                &lt;div class="col-1"&gt;&amp;nbsp;&lt;/div&gt;
                &lt;div class="col-11"&gt;
                    &lt;div class="form-group"&gt;
                        &lt;textarea class="form-control" id="comment" rows="3"&gt;&lt;/textarea&gt;
                    &lt;/div&gt;
                    &lt;button type="submit" class="btn btn-primary"&gt;Add Comment&lt;/button&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;!-- single comment --&gt;
            &lt;div class="row comment"&gt;
                &lt;div class="col-1"&gt;&amp;nbsp;&lt;/div&gt;
                &lt;div class="col-11"&gt;
                    &lt;span&gt;&lt;a href="#"&gt;&lt;i class="far fa-user"&gt;&lt;/i&gt; therealdanvega&lt;/a&gt;&lt;/span&gt;
                    &lt;span&gt;&lt;i class="far fa-clock"&gt;&lt;/i&gt; 4 hours ago&lt;/span&gt;
                    &lt;p class="body"&gt;It’s one thing I never care about, new releases of maven. Yet I do for most other things.. I really should take a look at any features released in the last while! Pull my dependencies, run my tests and upload to nexus. I don’t care for much else, I wonder what if any I’m missing.&lt;/p&gt;
                    &lt;a href="#" class="permalink"&gt;&lt;i class="fas fa-link"&gt;&lt;/i&gt; permalink&lt;/a&gt;
                    &lt;a href="#" class="like"&gt;&lt;i class="far fa-thumbs-up"&gt;&lt;/i&gt; Like&lt;/a&gt;
                &lt;/div&gt;
            &lt;/div&gt;

        &lt;/div&gt;

    &lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We need to get an instance of a link based on the id in the url. What happens if that id is something random though like 999? This is why Spring Data wants to return us an Optional by default. In this case we don&#8217;t need to do any null checking, we can simply ask the optional if a link is present. If it is we will send it down to our view page, if not we can redirect to our list page.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @GetMapping("/link/{id}")
    public String read(@PathVariable Long id,Model model) {
        Optional&lt;Link&gt; link = linkRepository.findById(id);
        if( link.isPresent() ) {
            model.addAttribute("link",link.get());
            model.addAttribute("success", model.containsAttribute("success"));
            return "link/view";
        } else {
            return "redirect:/";
        }
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_building_our_submit_page">Building our Submit Page</h4>
<div class="paragraph">
<p>We need to be able to add a new link to our database through the UI. To do so we are going to add a form that allows anyone to enter a title and a URL and submit it. When the submission happens we will perform some validation and if it passes, we will save that link to the database. After the link has been saved we will set a flash attribute and send the user to the view page for that link.</p>
</div>
<div class="paragraph">
<p>For this to work we are going to need 2 different handler methods in our controller, one to show the page and one to handle the submission. I am also going to add a logger to our page so I can add some logging information in our methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">private static final Logger logger = LoggerFactory.getLogger(LinkController.class);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @GetMapping("/link/submit")
    public String newLinkForm(Model model) {
        model.addAttribute("link",new Link());
        return "link/submit";
    }

    @PostMapping("/link/submit")
    public String createLink(@Valid Link link, BindingResult bindingResult, Model model, RedirectAttributes redirectAttributes) {
        return "link/submit";
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is what our submit page is going to look like. The key part to this page is the <code>th:object=""</code> expression. To learn more about Expressions on selections (asterisk syntax) <a href="https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#expressions-on-selections-asterisk-syntax">click here</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head th:replace="~{layouts/main_layout :: head(title='Springit - Spring Boot Reddit Clone')}"&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;nav th:replace="~{layouts/main_layout :: nav}"&gt;&lt;/nav&gt;
    &lt;div th:replace="~{layouts/main_layout :: jumbotron}"&gt;&lt;/div&gt;

    &lt;div class="container"&gt;

        &lt;div class="row"&gt;
            &lt;div class="col-md-3"&gt;&lt;/div&gt;
            &lt;div class="col-md-6"&gt;
                &lt;h4&gt;Submit Link&lt;/h4&gt;
                &lt;br/&gt;
                &lt;form id="frmAddLink" method="POST" th:action="@{/link/submit}" th:object="${link}"&gt;
                    &lt;div class="form-group"&gt;
                        &lt;label for="title"&gt;Title&lt;/label&gt;
                        &lt;input type="text"
                               class="form-control"
                               id="title"
                               placeholder="Enter Title"
                               required="required"
                               th:field="*{title}"&gt;
                        &lt;small th:errors="*{title}" style="color:red;"&gt;&lt;/small&gt;
                    &lt;/div&gt;
                    &lt;div class="form-group"&gt;
                        &lt;label for="url"&gt;URL&lt;/label&gt;
                        &lt;input type="url" class="form-control" id="url" placeholder="URL" required="required"
                               th:field="*{url}"&gt;
                        &lt;small th:errors="*{url}" style="color:red;"&gt;&lt;/small&gt;
                    &lt;/div&gt;
                    &lt;button type="submit" class="btn btn-primary"&gt;Submit&lt;/button&gt;
                &lt;/form&gt;
            &lt;/div&gt;
            &lt;div class="col-md-3"&gt;&lt;/div&gt;
        &lt;/div&gt;

    &lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_validation">Validation</h5>
<div class="paragraph">
<p>We perform validation by adding validation rules to our entity objects. We can use rules like</p>
</div>
<div class="ulist">
<ul>
<li>
<p>@NotNull</p>
</li>
<li>
<p>@NotEmpty</p>
</li>
<li>
<p>@URL</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are so many validation rules and these are a part of the <a href="https://docs.jboss.org/hibernate/validator/5.1/api/org/hibernate/validator/constraints/package-summary.html">Hibernate Validation Library</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_link_controller_methods_completed">Link Controller Methods Completed</h5>
<div class="paragraph">
<p>If we want to we can add a nice success message to our view page</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;div class="alert alert-success" role="alert" th:if="${success}"&gt;
    Your new link was created!
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is what the final controller methods look like.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@GetMapping("/link/submit")
public String newLinkForm(Model model) {
    model.addAttribute("link",new Link());
    return "link/submit";
}

@PostMapping("/link/submit")
public String createLink(@Valid Link link, BindingResult bindingResult, Model model, RedirectAttributes redirectAttributes) {
    if( bindingResult.hasErrors() ) {
        logger.info("Validation errors were found while submitting a new link.");
        model.addAttribute("link",link);
        return "link/submit";
    } else {
        // save our link
        linkRepository.save(link);
        logger.info("New Link was saved successfully.");
        redirectAttributes
                .addAttribute("id", link.getId())
                .addFlashAttribute("success",true);
        return "redirect:/link/{id}";
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spring_security">Spring Security</h3>
<div class="imageblock">
<div class="content">
<img src="images/spring-security.jpeg" alt="spring security">
</div>
</div>
<div class="sect3">
<h4 id="_spring_security_introduction">Spring Security Introduction</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
CREATE NEW BRANCH CALLED spring-security
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this lesson we are going to discuss a very important topic and that is security. It turns out that Security is really hard and it isn&#8217;t something that we want to build ourselves. Luckily for us the Spring Security project is the standard for securing Spring based applications and it is really good at it.</p>
</div>
<div class="paragraph">
<p>There were some important changes in Spring Boot 2 &amp; Spring Security 5 so we are going to dive right into those. In this section we will start by adding the spring boot security starter that will bring in most of everything we will need and from there we will gradually build on that until we have what we need to move forward.</p>
</div>
<div class="sect4">
<h5 id="_what_is_spring_security">What is Spring Security?</h5>
<div class="paragraph">
<p>Spring Security is a powerful and highly customizable authentication and access-control framework. It is the de-facto standard for securing Spring-based applications.</p>
</div>
<div class="paragraph">
<p>Spring Security is a framework that focuses on providing both authentication and authorization to Java applications. Like all Spring projects, the real power of Spring Security is found in how easily it can be extended to meet custom requirements</p>
</div>
<div class="paragraph">
<p><strong>Features</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Comprehensive and extensible support for both Authentication and Authorization</p>
</li>
<li>
<p>Protection against attacks like session fixation, clickjacking, cross site request forgery, etc</p>
</li>
<li>
<p>Servlet API integration</p>
</li>
<li>
<p>Optional integration with Spring Web MVC</p>
</li>
<li>
<p>Much more…</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_what_s_new_in_spring_boot_2_0">What&#8217;s new in Spring Boot 2.0</h5>
<div class="paragraph">
<p><a href="https://spring.io/blog/2017/09/15/security-changes-in-spring-boot-2-0-m4" class="bare">https://spring.io/blog/2017/09/15/security-changes-in-spring-boot-2-0-m4</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_getting_started">Getting Started</h5>
<div class="paragraph">
<p>To get started with Spring Security you can select it in the Spring Initializer or you can just include the Spring Boot Starter Security.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you cmd+click (ctrl+click on pc) on the artifact you can see what the starter includes.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If we go ahead and run the application we should see that everything is locked down by default. The reason for this is that this is the default configuration for web security.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/**
 * The default configuration for web security. It relies on Spring Security's
 * content-negotiation strategy to determine what sort of authentication to use. If the
 * user specifies their own {@link WebSecurityConfigurerAdapter}, this will back-off
 * completely and the users should specify all the bits that they want to configure as
 * part of the custom security configuration.
 *
 * @author Madhura Bhave
 * @since 2.0.0
 */
@ConditionalOnClass(WebSecurityConfigurerAdapter.class)
@ConditionalOnMissingBean(WebSecurityConfigurerAdapter.class)
@ConditionalOnWebApplication(type = Type.SERVLET)
public class SpringBootWebSecurityConfiguration {

	@Configuration
	@Order(SecurityProperties.BASIC_AUTH_ORDER)
	static class DefaultConfigurerAdapter extends WebSecurityConfigurerAdapter {

	}

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The default username is <code>user</code> and the password is generated and displayed in the console.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Using default security password: 78fa095d-3f4c-48b1-ad50-e24c31d5cf35</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to learn more you can start digging through the Spring Boot Reference docs on security.</p>
</div>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-security.html" class="bare">https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-security.html</a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_spring_security_configuration">Spring Security Configuration</h4>
<div class="paragraph">
<p>Now that Spring Security is on the class path everything is locked down. We don&#8217;t want visitors to have to login just to view data like our home page listing of links and a single link. To do this we need to setup our own security configuration. I am going to create a package called security and create a new class called <code>SecurityConfiguration</code> that will extend the <code>WebSecurityConfigurerAdapter</code>.</p>
</div>
<div class="paragraph">
<p>We are going to mark this class as a <code>@Configuration</code> class, <code>@EnableWebSecurity</code> and override the <code>configure(HttpSecurity http)</code> method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebSecurity
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {

    @Override
    protected void configure(HttpSecurity http) throws Exception {

    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now with that in place we can start to configure our application. If you want to learn more about what we are doing here check out the Spring Security documentation on <a href="https://docs.spring.io/spring-security/site/docs/current/reference/html/jc.html#jc-httpsecurity">HttpSecurity</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">protected void configure(HttpSecurity http) throws Exception {
    http
        .authorizeRequests()
            .anyRequest().authenticated()
            .and()
        .formLogin()
            .and()
        .httpBasic();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default configuration above:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ensures that any request to our application requires the user to be authenticated</p>
</li>
<li>
<p>Allows users to authenticate with form based login</p>
</li>
<li>
<p>Allows users to authenticate with HTTP Basic authentication</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Remember that rules are read top down. If you have a rule 1st it will override rules that follow. A quick way to test this is to have a rule that permits any request after the any request must be authenticated rule.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If we want to setup some roles for our default user we can by using the following property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring.security.user.roles=</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_users_roles">Users &amp; Roles</h4>
<div class="paragraph">
<p>In the last lesson we used the default user &amp; auto generated password to test our configuration. While It was good for a quick test we really need to implement something a little bit better. In this lesson we are going to create our User &amp; Role entities and hook them into Spring Security.</p>
</div>
<div class="sect4">
<h5 id="_authentication_vs_authorization">Authentication vs Authorization</h5>
<div class="paragraph">
<p>We have heard these terms a couple of times now so it seems like its a good time to talk about them. Spring Security is both an <code>Authentication</code> and <code>Authorization</code> framework so it&#8217;s important that we understand what both of those are.</p>
</div>
<div class="paragraph">
<p><strong>Authentication</strong> is the process of determining that somebody is really who they claim to be.</p>
</div>
<div class="paragraph">
<p><strong>Authorization</strong> is the process of verifying that you have access to something. Gaining access to a resource (e.g. a controller method or set of methods) because the permissions configured on it allow you access is authorization.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_user_role_entities">User &amp; Role Entities</h4>
<div class="paragraph">
<p><strong>Authentication: User</strong></p>
</div>
<div class="paragraph">
<p>For Authentication we are going to create a user class. A user class normally has some type of username field and in our case we are going to use the email address as the users <code>username</code>. The user will also need a password which will be stored in the database as encrypted text. It is never a good idea to store plain text passwords and It&#8217;s great to see that Spring Security doesn&#8217;t even give us this option.</p>
</div>
<div class="paragraph">
<p>To hook our user class into Spring Security we are going to implement Spring Security&#8217;s UserDetails class. By implementing this this interface we will need to provide a concrete implementation for the following methods.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Collection&lt;? extends GrantedAuthority&gt; getAuthorities();</p>
</li>
<li>
<p>String getPassword();</p>
</li>
<li>
<p>String getUsername();</p>
</li>
<li>
<p>boolean isAccountNonExpired();</p>
</li>
<li>
<p>boolean isAccountNonLocked();</p>
</li>
<li>
<p>boolean isCredentialsNonExpired();</p>
</li>
<li>
<p>boolean isEnabled();</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class User implements UserDetails {

    @Id @GeneratedValue
    private Long id;

    @NonNull
    @Size(min = 8, max = 20)
    @Column(nullable = false, unique = true)
    private String email;
    @NonNull

    @Column(length = 100)
    private String password;

    @NonNull
    @Column(nullable = false)
    private boolean enabled;

    @ManyToMany(fetch = FetchType.EAGER)
    @JoinTable(
            name = "users_roles",
            joinColumns = @JoinColumn(name = "user_id",referencedColumnName = "id"),
            inverseJoinColumns = @JoinColumn(name = "role_id",referencedColumnName = "id")
    )
    private Set&lt;Role&gt; roles = new HashSet&lt;&gt;();

    @Override
    public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() {
        return roles.stream().map(role -&gt; new SimpleGrantedAuthority(role.getName())).collect(Collectors.toList());
    }

    public void addRole(Role role) {
        roles.add(role);
    }

    public void addRoles(Set&lt;Role&gt; roles) {
        roles.forEach(this::addRole);
    }

    @Override
    public String getUsername() {
        return email;
    }

    @Override
    public boolean isAccountNonExpired() {
        return true;
    }

    @Override
    public boolean isAccountNonLocked() {
        return true;
    }

    @Override
    public boolean isCredentialsNonExpired() {
        return true;
    }

    @Override
    public boolean isEnabled() {
        return enabled;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Authorization: Role</strong></p>
</div>
<div class="paragraph">
<p>To make sure our user has access to something we will be creating a role class. This is simple class that contains the role name. When this is in place each user will have 1 or more roles that allow them to access certain parts of our application. For instance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A user must contain the <code>ROLE_USER</code> role to add a comment</p>
</li>
<li>
<p>A user must contain the <code>ROLE_USER</code> role to add a new link</p>
</li>
<li>
<p>A user must contain the <code>ROLE_USER</code> role to vote on a link</p>
</li>
<li>
<p>A user must contain the <code>ROLE_ADMIN</code> role to view actuator endpoints</p>
</li>
<li>
<p>etc&#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Role {

    @Id
    @GeneratedValue
    private Long id;

    @NonNull
    private String name;

    @ManyToMany( mappedBy = "roles")
    private Collection&lt;User&gt; users;

}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_user_role_repositories">User &amp; Role Repositories</h5>
<div class="paragraph">
<p>We will also create a User &amp; Role Repository.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface UserRepository extends JpaRepository&lt;User,Long&gt; {

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface RoleRepository extends JpaRepository&lt;Role,Long&gt; {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_user_details_service">User Details Service</h4>
<div class="paragraph">
<p>Core interface which loads user-specific data.It is used throughout the framework as a user DAO and is the strategy used by the DaoAuthenticationProvider.</p>
</div>
<div class="paragraph">
<p>The first thing we need to do is to override the configure method from our <code>WebSecurityConfigurerAdapter</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebSecurity
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {

    private UserDetailsServiceImpl userDetailsService;

    public SecurityConfiguration(UserDetailsServiceImpl userDetailsService) {
        this.userDetailsService = userDetailsService;
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        ...
    }

    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        auth.userDetailsService(userDetailsService);
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And then actually create the implementation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Service
public class UserDetailsServiceImpl implements UserDetailsService {

    private UserRepository userRepository;

    public UserDetailsServiceImpl(UserRepository userRepository) {
        this.userRepository = userRepository;
    }

    @Override
    public UserDetails loadUserByUsername(String email) throws UsernameNotFoundException {
        Optional&lt;User&gt; user = userRepository.findByEmail(email);
        if( !user.isPresent() ){
            throw new UsernameNotFoundException(email);
        }
        return user.get();
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface UserRepository extends JpaRepository&lt;User,Long&gt; {
    Optional&lt;User&gt; findByEmail(String email);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_databaseloader_adding_users_roles">DatabaseLoader - Adding Users &amp; Roles</h4>
<div class="paragraph">
<p>Now that we have everything in place we can add some data for us to use in our development environment. Remember that I told you earlier that we can&#8217;t store passwords in plain text, instead we encrypt them so that unwanted eyes can&#8217;t see our passwords. Instead of a password of <code>password</code> in the database you will see something like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$2a$10$XPvPcEZrjS35pYtF8M/Q4ewkXkovcB5oiEHi8Uehljkum1tzGr0NG</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are a few password encoders supported by Spring Security but in this example we will be using <code>BCrypt</code>. In the past we had to pass in a salt when encoding the password but BCrypt will generate a random salt for us. The Spring Security team announced that the PasswordEncoder in org.springframework.security.authentication.encoding as deprecated. The password encoder in <code>org.springframework.security.crypto.password</code> is what our BCrypt encoder is now using.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">/**
 * Service interface for encoding passwords.
 *
 * The preferred implementation is {@code BCryptPasswordEncoder}.
 *
 * @author Keith Donald
 */
public interface PasswordEncoder {

	/**
	 * Encode the raw password. Generally, a good encoding algorithm applies a SHA-1 or
	 * greater hash combined with an 8-byte or greater randomly generated salt.
	 */
	String encode(CharSequence rawPassword);

	/**
	 * Verify the encoded password obtained from storage matches the submitted raw
	 * password after it too is encoded. Returns true if the passwords match, false if
	 * they do not. The stored password itself is never decoded.
	 *
	 * @param rawPassword the raw password to encode and match
	 * @param encodedPassword the encoded password from storage to compare with
	 * @return true if the raw password, after encoding, matches the encoded password from
	 * storage
	 */
	boolean matches(CharSequence rawPassword, String encodedPassword);

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the past you could only use a single password encoding algorithm. Spring Security 5 introduced the concept of password encoding delegation. We can no offer encoding passwords using different algorithms. The way that Spring Security recognizes which algorithm you&#8217;re using is by prefixing the password with the encoder. Because we are using BCrypt we will end up storing our passwords in the database like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{bcrypt}$2a$10$XPvPcEZrjS35pYtF8M/Q4ewkXkovcB5oiEHi8Uehljkum1tzGr0NG</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the password hash has no prefix, Spring Security will use the default <code>StandardPasswordEncoder</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">private void addUsersAndRoles() {
    BCryptPasswordEncoder encoder = new BCryptPasswordEncoder();
    String secret = "{bcrypt}" + encoder.encode("password");

    Role userRole = new Role("ROLE_USER");
    roleRepository.save(userRole);
    Role adminRole = new Role("ROLE_ADMIN");
    roleRepository.save(adminRole);

    User user = new User("user@gmail.com",secret,true);
    user.addRole(userRole);
    userRepository.save(user);

    User admin = new User("admin@gmail.com",secret,true);
    admin.addRole(adminRole);
    userRepository.save(admin);

    User master = new User("super@gmail.com",secret,true);
    master.addRoles(new HashSet&lt;&gt;(Arrays.asList(userRole,adminRole)));
    userRepository.save(master);

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_auditing_2">Auditing</h4>
<div class="paragraph">
<p>Now that we have security in place and we have some users and roles it&#8217;s time we revisit something we did a little bit earlier. Remember when we created the Auditable domain class that all of our other domain classes extended? Well we have the created &amp; last updated dates working but now its time we tackle the user fields.</p>
</div>
<div class="paragraph">
<p>To make this happen we are going to remove the <code>@EnableJpaAuditing</code> annotation from our main Application class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@SpringBootApplication
@EnableJpaAuditing
public class SpringitApplication {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We are then going to create a new config package and a new class called JpaConfig. The auditorAwareRef configures the AuditorAware bean to be used to lookup the current principal.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableJpaAuditing(auditorAwareRef = "auditorAware")
public class JpaConfig {
    @Bean
    public AuditorAware&lt;String&gt; auditorAware() {
        return new AuditorAwareImpl();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next we will create the <code>AuditorAwareImpl</code> bean. We are implementing the <code>AuditorAware</code> interface and will need to override a single method called getCurrentAuditor. This will allow us to get the username (email in our case) of the currently logged in user.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class AuditorAwareImpl implements AuditorAware&lt;String&gt; {
    @Override
    public Optional&lt;String&gt; getCurrentAuditor() {
        return Optional.of(((User) SecurityContextHolder.getContext().getAuthentication().getPrincipal()).getEmail());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you try and run the application now you are going to run into some issues. Before reading any further do you know what is causing these issues?</p>
</div>
<div class="paragraph">
<p>The problem here is that we are trying to add some links in our <code>DatabaseLoader</code> CommandLineRunner. At this point in time there is no logged in user. To make this work for our development environment we need to check to see if there is no authenticated user and if there isn&#8217;t hard code an admin user.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class AuditorAwareImpl implements AuditorAware&lt;String&gt; {
    @Override
    public Optional&lt;String&gt; getCurrentAuditor() {
        if(SecurityContextHolder.getContext().getAuthentication() == null ) {
            return Optional.of("admin@gmail.com");
        } else {
            return Optional.of(((User) SecurityContextHolder.getContext().getAuthentication().getPrincipal()).getEmail());
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_actuator_security">Actuator Security</h4>
<div class="paragraph">
<p>Now that Spring Boot has backed off of Security we have a little bit of an issue with our actuator endpoints. Right now they are all wide open, so any user can get to them. In some cases this might be ok but in most it&#8217;s probably not. Let&#8217;s think about some rules that we want to incorporate for our actuator endpoints.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The "info" endpoint should be available to anyone</p>
</li>
<li>
<p>The "/actuator" endpoint that lists all available endpoints should be locked down</p>
</li>
<li>
<p>All other endpoints should be locked down.</p>
</li>
<li>
<p>Only users with the ROLE_ADMIN should be able to view the secure data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Spring Boot provides dedicated helpers to make your configuration more readable and explicit. For management endpoints and static resources, Spring Boot provides convenience factories that will supply the right RequestMatcher. For management endpoints, the RequestMatcher will be created based on the management.context-path. Using RequestMatchers gives users the flexibility to secure the application using existing Spring Security expressions such as permitAll, hasRole etc.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Override
protected void configure(HttpSecurity http) throws Exception {
    http
        .authorizeRequests()
            .requestMatchers(EndpointRequest.to("info")).permitAll()
            .requestMatchers(EndpointRequest.toAnyEndpoint()).hasRole("ADMIN")
            .antMatchers("/actuator/").hasRole("ACTUATOR")
            .and()
        .formLogin();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The EndpointRequest is especially helpful given that we can change our endpoint mappings from /actuator to something else like /monitoring using the following configuration property. Now if we were to change that our http security stays the same!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>management.endpoints.web.base-path=/monitoring</code></pre>
</div>
</div>
<div class="paragraph">
<p>The final thing we need to talk about is the health status endpoint. We have a property that allows us to show-details of the health endpoint. The important thing to remember here is that when_authorized can be any user that is authorized. That is why it&#8217;s important to remember to lock that endpoint down to a specific role like we did above.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>management.endpoint.health.show-details=when_authorized</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_h2_console">H2 Console</h5>
<div class="paragraph">
<p>If we try and go to our H2 Console (/h2-console) we won&#8217;t be able to get there. We need to do a couple of things to make this work. First we need to allow anyone to access /h2-console/**. This is only being used for development so I am fine with this rule for now.  We also need to disable CSRF and X-Frame-Options because H2 database console runs inside of a frame.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">protected void configure(HttpSecurity http) throws Exception {
    http
        .authorizeRequests()
            .requestMatchers(EndpointRequest.to("info")).permitAll()
            .requestMatchers(EndpointRequest.toAnyEndpoint()).hasRole("ACTUATOR")
            .antMatchers("/actuator/").hasRole("ACTUATOR")
            .antMatchers("/link/submit").hasRole("USER")
            .antMatchers("/link/**").permitAll()
            .antMatchers("/").permitAll()
            .antMatchers("/h2-console/**").permitAll()
            .and()
        .formLogin()
            .and()
        .csrf().disable()
        .headers().frameOptions().disable();
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
MAKE sure we have commits on our branch!
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_spring_security_the_view_layer">Spring Security: The View Layer</h4>
<div class="paragraph">
<p>What we looked at in the last section was how to configure Spring Security. Now that we have a head start on security it&#8217;s time we integrate into our view layer. Here is what we are going to cover in this section:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Custom Login Form</p>
</li>
<li>
<p>Form Login and Logout</p>
</li>
<li>
<p>Remember Me Feature</p>
</li>
<li>
<p>Thymeleaf Spring Security Dialect</p>
</li>
<li>
<p>Account &amp; Registration Templates</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
We are going to keep the same branch, so don&#8217;t go merging just yet!
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_form_login_logout">Form Login &amp; Logout</h4>
<div class="paragraph">
<p>You might be wondering where the login form came from when you were prompted to log in, since we made no mention of any HTML files or JSPs. Since Spring Security’s default configuration does not explicitly set a URL for the login page, Spring Security generates one automatically, based on the features that are enabled and using standard values for the URL which processes the submitted login, the default target URL the user will be sent to after logging in and so on.</p>
</div>
<div class="paragraph">
<p>While the automatically generated log in page is convenient to get up and running quickly, most applications will want to provide their own log in page. To do so we can update our configuration as seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">protected void configure(HttpSecurity http) throws Exception {
    http
        .authorizeRequests()
            .anyRequest().authenticated()
            .and()
        .formLogin()
            .loginPage("/login") // 1
            .permitAll(); // 2
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The updated configuration specifies the location of the log in page.</p>
</li>
<li>
<p>We must grant all users (i.e. unauthenticated users) access to our log in page. The formLogin().permitAll() method allows granting access to all users for all URLs associated with form based log in.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now we need to setup a request handler for /login. I am going to create an <code>AuthController</code> that looks like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Controller
public class AuthController {

    @GetMapping("/login")
    public String login(){
        return "auth/login";
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next we need to update our login template to use our layout. This form contains all of the pieces we will need for our form.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head th:replace="~{layouts/main_layout :: head(title = 'Springit - Login')}"&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;nav th:replace="~{layouts/main_layout :: nav}"&gt;&lt;/nav&gt;
    &lt;div th:replace="~{layouts/main_layout :: jumbotron}"&gt;&lt;/div&gt;

    &lt;div class="container"&gt;

        &lt;!-- login --&gt;
        &lt;form class="form-horizontal" role="form" method="POST" th:action="@{/login}"&gt;
            &lt;div class="row"&gt;
                &lt;div class="col-md-3"&gt;&lt;/div&gt;
                &lt;div class="col-md-6"&gt;
                    &lt;h2&gt;Please Login&lt;/h2&gt;
                    &lt;hr&gt;
                    &lt;div class="alert alert-danger" th:if="${param.error != null}"&gt;
                        Invalid username and password.
                    &lt;/div&gt;
                    &lt;div class="alert alert-success" th:if="${param.logout != null}"&gt;
                        You have been logged out.
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="col-md-3"&gt;&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="row"&gt;
                &lt;div class="col-md-3"&gt;&lt;/div&gt;
                &lt;div class="col-md-6"&gt;
                    &lt;div class="form-group has-danger"&gt;
                        &lt;label class="sr-only" for="email"&gt;E-Mail Address&lt;/label&gt;
                        &lt;div class="input-group mb-2 mr-sm-2 mb-sm-0"&gt;
                            &lt;div class="input-group-addon" style="width: 2.6rem"&gt;&lt;i class="fa fa-at"&gt;&lt;/i&gt;&lt;/div&gt;
                            &lt;input type="text" name="email" class="form-control" id="email" placeholder="you@example.com" required autofocus&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="col-md-3"&gt;&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="row"&gt;
                &lt;div class="col-md-3"&gt;&lt;/div&gt;
                &lt;div class="col-md-6"&gt;
                    &lt;div class="form-group"&gt;
                        &lt;label class="sr-only" for="password"&gt;Password&lt;/label&gt;
                        &lt;div class="input-group mb-2 mr-sm-2 mb-sm-0"&gt;
                            &lt;div class="input-group-addon" style="width: 2.6rem"&gt;&lt;i class="fa fa-key"&gt;&lt;/i&gt;&lt;/div&gt;
                            &lt;input type="password" name="password" class="form-control" id="password" placeholder="Password" required&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="col-md-3"&gt;&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="row"&gt;
                &lt;div class="col-md-3"&gt;&lt;/div&gt;
                &lt;div class="col-md-6" style="padding-top: .35rem"&gt;
                    &lt;div class="form-check mb-2 mr-sm-2 mb-sm-0"&gt;
                        &lt;label class="form-check-label"&gt;
                            &lt;input id="remember-me" name="remember-me" class="form-check-input" type="checkbox" &gt;
                            &lt;span style="padding-bottom: .15rem"&gt;Remember me&lt;/span&gt;
                        &lt;/label&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="col-md-3"&gt;&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="row" style="padding-top: 1rem"&gt;
                &lt;div class="col-md-3"&gt;&lt;/div&gt;
                &lt;div class="col-md-6"&gt;
                    &lt;button type="submit" class="btn btn-success"&gt;&lt;i class="fas fa-sign-in-alt"&gt;&lt;/i&gt; Login&lt;/button&gt;
                    &lt;!-- &lt;a class="btn btn-link" href="forgotPassword.html"&gt;Forgot Your Password?&lt;/a&gt; --&gt;
                &lt;/div&gt;
                &lt;div class="col-md-3"&gt;&lt;/div&gt;
            &lt;/div&gt;
        &lt;/form&gt;

    &lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
We turned off CSRF earlier for the H2 Console to work. We want this on, enable it and read more about it here <a href="https://docs.spring.io/spring-security/site/docs/current/reference/html/web-app-security.html#csrf-configure" class="bare">https://docs.spring.io/spring-security/site/docs/current/reference/html/web-app-security.html#csrf-configure</a>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_username_password_form_parameters">Username &amp; Password Form Parameters</h5>
<div class="paragraph">
<p>There is just one more step to do to make this all work. I bet you&#8217;re probably thinking that we need to create a handler method for our login submit but we actually don&#8217;t have to. Spring Security handles all of that for us. When we submit a form Spring Security is expecting 2 things from us:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The username must be present as the HTTP parameter named username</p>
</li>
<li>
<p>The password must be present as the HTTP parameter named password</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Since our field is named "email" we just need to add one more configuration to our form login and that is <code>usernameParameter("email")</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Override
protected void configure(HttpSecurity http) throws Exception {
    http
        .authorizeRequests()
            .requestMatchers(EndpointRequest.to("info")).permitAll()
            .requestMatchers(EndpointRequest.toAnyEndpoint()).hasRole("ACTUATOR")
            .antMatchers("/actuator/").hasRole("ACTUATOR")
            .antMatchers("/link/submit").hasRole("USER")
            .antMatchers("/link/**").permitAll()
            .antMatchers("/").permitAll()
            .antMatchers("/h2-console/**").permitAll()
            .and()
        .formLogin()
            .loginPage("/login").permitAll()
            .usernameParameter("email");
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_form_logout">Form Logout</h5>
<div class="paragraph">
<p>When using the WebSecurityConfigurerAdapter, logout capabilities are automatically applied. The default is that accessing the URL /logout will log the user out by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Invalidating the HTTP Session</p>
</li>
<li>
<p>Cleaning up any RememberMe authentication that was configured</p>
</li>
<li>
<p>Clearing the SecurityContextHolder</p>
</li>
<li>
<p>Redirect to /login?logout</p>
</li>
<li>
<p>Similar to configuring login capabilities, however, you also have various options to further customize your logout requirements:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you wanted to you could further customize the logout experience</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">protected void configure(HttpSecurity http) throws Exception {
    http
        .logout()
            .logoutUrl("/my/logout")
            .logoutSuccessUrl("/my/index")
            .logoutSuccessHandler(logoutSuccessHandler)
            .invalidateHttpSession(true)
            .addLogoutHandler(logoutHandler)
            .deleteCookies(cookieNamesToClear)
            .and()
        ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you get a logout 404 error this is why <a href="https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#csrf-logout" class="bare">https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#csrf-logout</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/logout_404.png" alt="logout 404">
</div>
</div>
<div class="paragraph">
<p>I updated our main_layout to use a POST instead of a GET</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;li class="nav-item"&gt;
    &lt;form method="POST" th:action="@{/logout}"&gt;
    &lt;button class="nav-link"&gt;&lt;i class="fa fa-sign-out-alt" aria-hidden="true"&gt;&lt;/i&gt; Sign Out&lt;/button&gt;
    &lt;/form&gt;
&lt;/li&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Fixing our button style</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>button.nav-link {
    background: #2D2A27;
    border:none;
    cursor: pointer;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the logout started working just fine.</p>
</div>
</div>
<div class="sect4">
<h5 id="_remember_me">Remember Me</h5>
<div class="paragraph">
<p>Remember-me or persistent-login authentication refers to web sites being able to remember the identity of a principal between sessions. This is typically accomplished by sending a cookie to the browser, with the cookie being detected during future sessions and causing automated login to take place. Spring Security provides the necessary hooks for these operations to take place, and has two concrete remember-me implementations. One uses hashing to preserve the security of cookie-based tokens and the other uses a database or other persistent storage mechanism to store the generated tokens.</p>
</div>
<div class="paragraph">
<p>Learn more about both approaches to remember-me:</p>
</div>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-security/site/docs/5.1.1.RELEASE/reference/htmlsingle/#remember-me" class="bare">https://docs.spring.io/spring-security/site/docs/5.1.1.RELEASE/reference/htmlsingle/#remember-me</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">protected void configure(HttpSecurity http) throws Exception {
    http
        .authorizeRequests()
            .requestMatchers(EndpointRequest.to("info")).permitAll()
            .requestMatchers(EndpointRequest.toAnyEndpoint()).hasRole("ACTUATOR")
            .antMatchers("/actuator/").hasRole("ACTUATOR")
            .antMatchers("/link/submit").hasRole("USER")
            .antMatchers("/link/**").permitAll()
            .antMatchers("/").permitAll()
            .antMatchers("/vote/**").permitAll()
            .antMatchers("/h2-console/**").permitAll()
            .and()
        .formLogin()
            .loginPage("/login").permitAll()
            .usernameParameter("email")
            .and()
        .logout()
            .and()
        .rememberMe()
            .and()
        .csrf().disable()
        .headers().frameOptions().disable();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_thymeleaf_spring_security">Thymeleaf + Spring Security</h4>
<div class="paragraph">
<p>In Spring MVC environments, the <a href="https://github.com/thymeleaf/thymeleaf-extras-springsecurity">Spring Security integration module</a> works as a replacement of the Spring security taglib.</p>
</div>
<div class="paragraph">
<p>We use this dialect in the example in order to print the logged user credentials and to show different content to different roles.</p>
</div>
<div class="paragraph">
<p>The sec:authorize attribute renders its content when the attribute expression is evaluated to true:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;div sec:authorize="isAuthenticated()"&gt;
  This content is only shown to authenticated users.
&lt;/div&gt;
&lt;div sec:authorize="hasRole('ROLE_ADMIN')"&gt;
  This content is only shown to administrators.
&lt;/div&gt;
&lt;div sec:authorize="hasRole('ROLE_USER')"&gt;
  This content is only shown to users.
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The sec:authentication attribute is used to print logged user name and roles:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">Logged user: &lt;span sec:authentication="name"&gt;Bob&lt;/span&gt;
Roles: &lt;span sec:authentication="principal.authorities"&gt;[ROLE_USER, ROLE_ADMIN]&lt;/span&gt;</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_getting_started_2">Getting Started</h5>
<div class="paragraph">
<p>This is one of the first dependencies that we will come across that isn&#8217;t in the Spring Initializer and will need to be added manually. It also worth pointing out that this isn&#8217;t officially a part of the Thymeleaf project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt;
    &lt;artifactId&gt;thymeleaf-extras-springsecurity5&lt;/artifactId&gt;
    &lt;version&gt;3.0.4.RELEASE&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
There is something you will need to do for now to get the dialect working. If you&#8217;re on Spring Boot 2 and Spring Security 5 you will need to include this in your main application class until Spring Boot&#8217;s starter includes it.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// TODO * Configuring this bean should not be needed once Spring Boot's Thymeleaf starter includes configuration
// TODO   for thymeleaf-extras-springsecurity5 (instead of thymeleaf-extras-springsecurity4)
@Bean
public SpringSecurityDialect securityDialect() {
    return new SpringSecurityDialect();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Anywhere that we are going to use the Spring Security Thymeleaf extras we will need to use the correct namespace.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;html xmlns:sec="http://www.thymeleaf.org/extras/spring-security"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, lets update our main layout so only certain buttons are shown when we are logged in.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!-- if user is signed in --&gt;
&lt;li class="nav-item" sec:authorize="isAuthenticated()"&gt;
    &lt;a class="nav-link" th:href="@{/link/submit}"&gt;
        &lt;i class="fa fa-link" aria-hidden="true"&gt;&lt;/i&gt; Submit Link&lt;/a&gt;
&lt;/li&gt;
&lt;li class="nav-item" sec:authorize="isAuthenticated()"&gt;
    &lt;a class="nav-link" th:href="@{/profile}"&gt;
        &lt;i class="fa fa-user" aria-hidden="true"&gt;&lt;/i&gt; Account&lt;/a&gt;
&lt;/li&gt;
&lt;li class="nav-item"&gt;
    &lt;form method="POST" th:action="@{/logout}" sec:authorize="isAuthenticated()"&gt;
    &lt;button class="nav-link"&gt;&lt;i class="fa fa-sign-out-alt" aria-hidden="true"&gt;&lt;/i&gt; Sign Out&lt;/button&gt;
    &lt;/form&gt;
&lt;/li&gt;

&lt;!-- if user is not signed in --&gt;
&lt;li class="nav-item" sec:authorize="!isAuthenticated()"&gt;
    &lt;a class="nav-link" th:href="@{/login}"&gt;
        &lt;i class="fa fa-sign-in-alt" aria-hidden="true"&gt;&lt;/i&gt; Sign In&lt;/a&gt;
&lt;/li&gt;
&lt;li class="nav-item" sec:authorize="!isAuthenticated()"&gt;
    &lt;a class="nav-link" th:href="@{/register}"&gt;
        &lt;i class="fa fa-user-plus" aria-hidden="true"&gt;&lt;/i&gt; Register&lt;/a&gt;
&lt;/li&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_who_submitted_the_link">Who Submitted the link</h4>
<div class="paragraph">
<p>One thing that I noticed is that we never updated the display to show who actually submitted the link. I will admit that not having a username or a full name on the User object is going to hurt us here. I wanted to try and keep this simple so we are just going to display the Audit information and use the email. I might come back and add this as an assignment for you to work on later.</p>
</div>
<div class="paragraph">
<p>First we will need to update our home page to show the user who submitted the link.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;p class="tagline "&gt;submitted
    &lt;time th:title="${link.getCreationDate()}" th:datetime="${link.getCreationDate()}" class="live-timestamp" th:text="${link.getPrettyTime()}"&gt;1 hour(s)&lt;/time&gt; by
    &lt;a href="/" class="author" th:text="${link.createdBy}"&gt;therealdanvega&lt;/a&gt;
&lt;/p&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we also need to update this in the view link.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;p class="tagline "&gt;submitted
    &lt;time th:title="${link.getCreationDate()}" th:datetime="${link.getCreationDate()}" class="live-timestamp" th:text="${link.getPrettyTime()}"&gt;1 hour(s)&lt;/time&gt; by
    &lt;a href="/" class="author" th:text="${link.createdBy}"&gt;therealdanvega&lt;/a&gt;
    &lt;span class="userattrs"&gt;&lt;/span&gt;
&lt;/p&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again not ideal because its showing the email address but for simplicity sake we will keep it for now.</p>
</div>
</div>
<div class="sect3">
<h4 id="_account_registration">Account &amp; Registration</h4>
<div class="paragraph">
<p>When we updated the links in the navbar I added some routes to them. The account link goes to <code>/profile</code> and the Register link goes to <code>/register</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;li class="nav-item" sec:authorize="isAuthenticated()"&gt;
    &lt;a class="nav-link" th:href="@{/profile}"&gt;
        &lt;i class="fa fa-user" aria-hidden="true"&gt;&lt;/i&gt; Account&lt;/a&gt;
&lt;/li&gt;
&lt;li class="nav-item" sec:authorize="!isAuthenticated()"&gt;
    &lt;a class="nav-link" th:href="@{/register}"&gt;
        &lt;i class="fa fa-user-plus" aria-hidden="true"&gt;&lt;/i&gt; Register&lt;/a&gt;
&lt;/li&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We are going to need a couple of mappings for those and the <code>AuthController</code> seems like a good place to put them so let&#8217;s add these there:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@GetMapping("/profile")
public String profile() {
    return "auth/profile";
}

@GetMapping("/register")
public String register() {
    return "auth/register";
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We just need to update those views so they use our layout. We aren&#8217;t going to make these actually work just yet, I just want them looking nice.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head th:replace="~{layouts/main_layout :: head(title = 'Springit - Account Profile Page')}"&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;nav th:replace="~{layouts/main_layout :: nav}"&gt;&lt;/nav&gt;
    &lt;div th:replace="~{layouts/main_layout :: jumbotron}"&gt;&lt;/div&gt;

    &lt;!-- profile --&gt;
    &lt;div id="profile" class="container"&gt;

        &lt;div class="row"&gt;
            &lt;ul class="nav"&gt;
                &lt;li class="nav-item"&gt;
                    &lt;a class="nav-link active" href="#"&gt;Overview&lt;/a&gt;
                &lt;/li&gt;
                &lt;li class="nav-item"&gt;
                    &lt;a class="nav-link" href="#"&gt;Posts&lt;/a&gt;
                &lt;/li&gt;
                &lt;li class="nav-item"&gt;
                    &lt;a class="nav-link" href="#"&gt;Comments&lt;/a&gt;
                &lt;/li&gt;
                &lt;li class="nav-item"&gt;
                    &lt;a class="nav-link" href="#"&gt;Preferences&lt;/a&gt;
                &lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;

        &lt;div class="row"&gt;

            &lt;div class="col-8"&gt;
                &lt;div class="row"&gt;
                    &lt;div class="card col-12" style="width: 18rem;"&gt;
                        &lt;div class="card-body"&gt;
                            &lt;h5 class="card-title"&gt;What's new in Spring Boot 2&lt;/h5&gt;
                            &lt;h6 class="card-subtitle mb-2 text-muted"&gt;submitted 7 days ago by therealdanvega&lt;/h6&gt;
                            &lt;p class="card-text"&gt;Some quick example text to build on the card title and make up the bulk of the card's content.&lt;/p&gt;
                            &lt;a href="#" class="card-link"&gt;8 Comments&lt;/a&gt;
                            &lt;a href="#" class="card-link"&gt;Share&lt;/a&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="row"&gt;
                    &lt;div class="card col-12" style="width: 18rem;"&gt;
                        &lt;div class="card-body"&gt;
                            &lt;h5 class="card-title"&gt;What's new in Spring Boot 2&lt;/h5&gt;
                            &lt;h6 class="card-subtitle mb-2 text-muted"&gt;submitted 7 days ago by therealdanvega&lt;/h6&gt;
                            &lt;p class="card-text"&gt;Some quick example text to build on the card title and make up the bulk of the card's content.&lt;/p&gt;
                            &lt;a href="#" class="card-link"&gt;8 Comments&lt;/a&gt;
                            &lt;a href="#" class="card-link"&gt;Share&lt;/a&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="row"&gt;
                    &lt;div class="card col-12" style="width: 18rem;"&gt;
                        &lt;div class="card-body"&gt;
                            &lt;h5 class="card-title"&gt;What's new in Spring Boot 2&lt;/h5&gt;
                            &lt;h6 class="card-subtitle mb-2 text-muted"&gt;submitted 7 days ago by therealdanvega&lt;/h6&gt;
                            &lt;p class="card-text"&gt;Some quick example text to build on the card title and make up the bulk of the card's content.&lt;/p&gt;
                            &lt;a href="#" class="card-link"&gt;8 Comments&lt;/a&gt;
                            &lt;a href="#" class="card-link"&gt;Share&lt;/a&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="row"&gt;
                    &lt;div class="card col-12" style="width: 18rem;"&gt;
                        &lt;div class="card-body"&gt;
                            &lt;h5 class="card-title"&gt;What's new in Spring Boot 2&lt;/h5&gt;
                            &lt;h6 class="card-subtitle mb-2 text-muted"&gt;submitted 7 days ago by therealdanvega&lt;/h6&gt;
                            &lt;p class="card-text"&gt;Some quick example text to build on the card title and make up the bulk of the card's content.&lt;/p&gt;
                            &lt;a href="#" class="card-link"&gt;8 Comments&lt;/a&gt;
                            &lt;a href="#" class="card-link"&gt;Share&lt;/a&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="row"&gt;
                    &lt;div class="card col-12" style="width: 18rem;"&gt;
                        &lt;div class="card-body"&gt;
                            &lt;h5 class="card-title"&gt;What's new in Spring Boot 2&lt;/h5&gt;
                            &lt;h6 class="card-subtitle mb-2 text-muted"&gt;submitted 7 days ago by therealdanvega&lt;/h6&gt;
                            &lt;p class="card-text"&gt;Some quick example text to build on the card title and make up the bulk of the card's content.&lt;/p&gt;
                            &lt;a href="#" class="card-link"&gt;8 Comments&lt;/a&gt;
                            &lt;a href="#" class="card-link"&gt;Share&lt;/a&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;!-- Right Side --&gt;
            &lt;div class="col-3 offset-1"&gt;
                &lt;div class="row"&gt;
                    &lt;div class="card col-12"&gt;
                        &lt;img class="card-img-top" th:src="@{/images/profile_small.png}" alt="Card image cap"&gt;
                        &lt;div class="card-body"&gt;
                            &lt;p class="card-text"&gt;
                                &lt;a href="/u/therealdanvega"&gt;/u/therealdanvega&lt;/a&gt;
                            &lt;/p&gt;
                            &lt;a href="../link/submit.html"&gt;&lt;button type="button" class="btn btn-primary btn-lg btn-block"&gt;New Post&lt;/button&gt;&lt;/a&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="row"&gt;
                    &lt;div class="card col-12"&gt;
                        &lt;!-- &lt;img class="card-img-top" src="..." alt="Card image cap"&gt; --&gt;
                        &lt;div class="card-body"&gt;
                            &lt;h5 class="card-title"&gt;Your Information&lt;/h5&gt;
                            &lt;p class="card-text"&gt;
                                Posts: 10&lt;br/&gt;
                                Comments: 3&lt;br/&gt;
                                User Since: November 23, 2017&lt;br/&gt;
                            &lt;/p&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="row"&gt;
                    &lt;div class="card col-12"&gt;
                        &lt;h5 class="card-title recentLinks"&gt;Recent Links Clicked&lt;/h5&gt;
                        &lt;ul class="list-group list-group-flush"&gt;
                            &lt;li class="list-group-item"&gt;&lt;a href="#"&gt;What's new in Spring Boot 2&lt;/a&gt;&lt;/li&gt;
                            &lt;li class="list-group-item"&gt;&lt;a href="#"&gt;10 Features in Java 10&lt;/a&gt;&lt;/li&gt;
                            &lt;li class="list-group-item"&gt;&lt;a href="#"&gt;9 Features in Java 9&lt;/a&gt;&lt;/li&gt;
                            &lt;li class="list-group-item"&gt;&lt;a href="#"&gt;8 Features in Java 8&lt;/a&gt;&lt;/li&gt;
                            &lt;li class="list-group-item"&gt;&lt;a href="#"&gt;7 Reasons not to use Java 7&lt;/a&gt;&lt;/li&gt;
                        &lt;/ul&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

        &lt;/div&gt; &lt;!-- // row --&gt;

    &lt;/div&gt;&lt;!-- // profile --&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head th:replace="~{layouts/main_layout :: head(title = 'Springit - Register for an account')}"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;nav th:replace="~{layouts/main_layout :: nav}"&gt;&lt;/nav&gt;
    &lt;div th:replace="~{layouts/main_layout :: jumbotron}"&gt;&lt;/div&gt;

    &lt;!-- User Registration form --&gt;
    &lt;form class="form-horizontal" role="form" method="POST" action=""&gt;
        &lt;div class="row"&gt;
            &lt;div class="col-md-3"&gt;&lt;/div&gt;
            &lt;div class="col-md-6"&gt;
                &lt;h2&gt;Register New User&lt;/h2&gt;
                &lt;hr&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="row"&gt;
            &lt;div class="col-md-3 field-label-responsive"&gt;
                &lt;label for="name"&gt;Name&lt;/label&gt;
            &lt;/div&gt;
            &lt;div class="col-md-6"&gt;
                &lt;div class="form-group"&gt;
                    &lt;div class="input-group mb-2 mr-sm-2 mb-sm-0"&gt;
                        &lt;div class="input-group-addon" style="width: 2.6rem"&gt;&lt;i class="fa fa-user"&gt;&lt;/i&gt;&lt;/div&gt;
                        &lt;input type="text" name="name" class="form-control" id="name"
                               placeholder="John Doe" required autofocus&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="col-md-3"&gt;
                &lt;div class="form-control-feedback"&gt;
                            &lt;span class="text-danger align-middle"&gt;
                                &lt;!-- Put name validation error messages here --&gt;
                            &lt;/span&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="row"&gt;
            &lt;div class="col-md-3 field-label-responsive"&gt;
                &lt;label for="email"&gt;E-Mail Address&lt;/label&gt;
            &lt;/div&gt;
            &lt;div class="col-md-6"&gt;
                &lt;div class="form-group"&gt;
                    &lt;div class="input-group mb-2 mr-sm-2 mb-sm-0"&gt;
                        &lt;div class="input-group-addon" style="width: 2.6rem"&gt;&lt;i class="fa fa-at"&gt;&lt;/i&gt;&lt;/div&gt;
                        &lt;input type="text" name="email" class="form-control" id="email"
                               placeholder="you@example.com" required autofocus&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="col-md-3"&gt;
                &lt;div class="form-control-feedback"&gt;
                            &lt;span class="text-danger align-middle"&gt;
                                &lt;!-- Put e-mail validation error messages here --&gt;
                            &lt;/span&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="row"&gt;
            &lt;div class="col-md-3 field-label-responsive"&gt;
                &lt;label for="password"&gt;Password&lt;/label&gt;
            &lt;/div&gt;
            &lt;div class="col-md-6"&gt;
                &lt;div class="form-group has-danger"&gt;
                    &lt;div class="input-group mb-2 mr-sm-2 mb-sm-0"&gt;
                        &lt;div class="input-group-addon" style="width: 2.6rem"&gt;&lt;i class="fas fa-key"&gt;&lt;/i&gt;&lt;/div&gt;
                        &lt;input type="password" name="password" class="form-control" id="password"
                               placeholder="Password" required&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="col-md-3"&gt;
                &lt;div class="form-control-feedback"&gt;
                            &lt;span class="text-danger align-middle"&gt;
                                Example Error Message
                            &lt;/span&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="row"&gt;
            &lt;div class="col-md-3 field-label-responsive"&gt;
                &lt;label for="password"&gt;Confirm Password&lt;/label&gt;
            &lt;/div&gt;
            &lt;div class="col-md-6"&gt;
                &lt;div class="form-group"&gt;
                    &lt;div class="input-group mb-2 mr-sm-2 mb-sm-0"&gt;
                        &lt;div class="input-group-addon" style="width: 2.6rem"&gt;
                            &lt;i class="fas fa-key"&gt;&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;input type="password" name="password-confirmation" class="form-control"
                               id="password-confirm" placeholder="Password" required&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="row"&gt;
            &lt;div class="col-md-3"&gt;&lt;/div&gt;
            &lt;div class="col-md-6"&gt;
                &lt;button type="submit" class="btn btn-success"&gt;&lt;i class="fa fa-user-plus"&gt;&lt;/i&gt; Register&lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/form&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_voting">Voting</h3>
<div class="sect3">
<h4 id="_voting_2">Voting</h4>
<div class="paragraph">
<p>Before we can work on our voting mechanism we need to discuss what exactly it is and what we want to accomplish here. When you are looking at a list of links or posts on Reddit you have the opportunity to up vote or down vote.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/reddit_spring_boot.png" alt="reddit spring boot">
</div>
</div>
<div class="paragraph">
<p>Here is an explanation right from the <a href="https://www.reddit.com/wiki/faq" class="bare">https://www.reddit.com/wiki/faq</a> [Reddit FAQ] on scores.</p>
</div>
<div class="paragraph">
<p><strong>How is a submission&#8217;s score determined?</strong></p>
</div>
<div class="paragraph">
<p>A submission&#8217;s score is simply the number of upvotes minus the number of downvotes. If five users like the submission and three users don&#8217;t it will have a score of 2. Please note that the vote numbers are not "real" numbers, they have been "fuzzed" to prevent spam bots etc. So taking the above example, if five users upvoted the submission, and three users downvote it, the upvote/downvote numbers may say 23 upvotes and 21 downvotes, or 12 upvotes, and 10 downvotes. The points score is correct, but the vote totals are "fuzzed".</p>
</div>
<div class="sect4">
<h5 id="_springit_scores">Springit Scores</h5>
<div class="paragraph">
<p>We are going to simplify this so we don&#8217;t get out of hand. We are going to allow any user the ability to up vote and down vote a link as many times as they want. The way we are going to go about this though should allow you to make a few changes and prevent this.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vote_entity_repository">Vote Entity &amp; Repository</h4>
<div class="paragraph">
<p>The first thing we need to do to make our voting mechnaism work is to setup a Vote Entity &amp; Repository. The Entity is going to be pretty simple and contain an id, direction and link. The direction will tell us if this record is an upvote (1) or downvote (-1).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Entity
@NoArgsConstructor
@RequiredArgsConstructor
@Getter
@Setter
public class Vote extends Auditable {

    @Id
    @GeneratedValue
    private Long id;

    @NonNull
    private short direction;

    @NonNull
    @ManyToOne
    private Link link;

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
if you want to prevent users from voting multiple times you would want to store the UserID on the vote to see if they have voted on this link already or not.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We also need to make a few changes to the <code>Link</code> Entity. We are adding the association from Link to Vote but this just gives us a list of votes for each Link. If we wanted to know the total we would have to loop through our votes and sum them up right? We can&#8217;t just ask for a <code>votes.size()</code> because that will just give us the number of votes, not the actual vote sum.</p>
</div>
<div class="paragraph">
<p>To fix this we are going to store a voteCount and start it at 0. We would not want to calculate this for each and every link every single time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @OneToMany(mappedBy = "link")
    private List&lt;Vote&gt; votes = new ArrayList&lt;&gt;();

    private int voteCount = 0;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally we will create a Repository for our Vote Domain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface VoteRepository extends JpaRepository&lt;Vote,Long&gt; {

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vote_controller">Vote Controller</h4>
<div class="paragraph">
<p>Now that we have a Vote Entity and Repository we can begin to work on our controller. We are going to create a new controller called <code>VoteController</code> and walk through what this actually needs to do.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestController
public class VoteController {

    private VoteRepository voteRepository;
    private LinkRepository linkRepository;

    public VoteController(VoteRepository voteRepository, LinkRepository linkRepository) {
        this.voteRepository = voteRepository;
        this.linkRepository = linkRepository;
    }

    @Secured({"ROLE_USER"})
    @GetMapping("/vote/link/{linkID}/direction/{direction}/votecount/{voteCount}")
    public int vote(@PathVariable Long linkID, @PathVariable short direction, @PathVariable int voteCount) {
        Optional&lt;Link&gt; optionalLink = linkRepository.findById(linkID);
        if( optionalLink.isPresent() ) {
            Link link = optionalLink.get();
            Vote vote = new Vote(direction,link);
            voteRepository.save(vote);

            int updatedVoteCount = voteCount + direction;
            link.setVoteCount(updatedVoteCount);
            linkRepository.save(link);
            return updatedVoteCount;
        }

        return voteCount;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that our controller is done we need to make our front end work.</p>
</div>
</div>
<div class="sect3">
<h4 id="_up_vote_down_vote">Up Vote &amp; Down Vote</h4>
<div class="paragraph">
<p>To make our up vote and down vote actually work we need to do some work on our home page. What we want to do here is add some functionality that will allow the user to click on an arrow and call our <code>VoteController</code>.</p>
</div>
<div class="paragraph">
<p>The first thing we need to do is update our code to add a few attributes. This is just going to help us write our script that calls our API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;div class="col-1"&gt;
    &lt;div&gt;&lt;a href="#" class="upvote" th:data-id="${link.id}"&gt;&lt;i class="fas fa-arrow-up"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/div&gt;
    &lt;div&gt;&lt;span th:id="|votecount-${link.id}|" class="votecount" th:text="${link.getVoteCount()}"&gt;0&lt;/span&gt;&lt;/div&gt;
    &lt;div&gt;&lt;a href="#" class="downvote" th:data-id="${link.id}" th:disabled="true"&gt;&lt;i class="fas fa-arrow-down"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next we will create a script that gets all of the vote links and adds a click event listener to them. Finally we get some data together and then call our API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">&lt;script&gt;
    const allvotes = document.querySelectorAll(".upvote, .downvote");
    for(let i=0; i&lt;allvotes.length; i++) {
        let className = allvotes[i].className;
        allvotes[i].addEventListener('click', function (event) {
            const direction = className === 'upvote' ? 1 : -1;
            const linkID = this.getAttribute("data-id");
            const voteSum = document.getElementById('votecount-' + linkID);
            const voteSumValue = voteSum.innerHTML;
            fetch(`http://localhost:8080/vote/link/${linkID}/direction/${direction}/votecount/${voteSumValue}`)
                .then(response =&gt; response.json())
                .then(data =&gt; voteSum.innerHTML = data)
                .catch(err =&gt; console.error(err));
        });
    }
&lt;/script&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Take a look at the H2 Console and look at the vote_count column!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Everything is starting to look pretty good but we still have one issue. Nothing is really secure and we have an issue if we aren&#8217;t logged in and try to vote.</p>
</div>
<div class="sect4">
<h5 id="_security">Security</h5>
<div class="paragraph">
<p>The first thing we need to fix is the error that is happening when we try and vote when we aren&#8217;t logged in. In our AuditorAwareImpl we try and get the authentication object and if it isn&#8217;t null we get the user. The problem here is that in this case the authentication object isn&#8217;t null but we actually don&#8217;t have a logged in user. This is because by default there is an "anonymousUser" and we need to check for that.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class AuditorAwareImpl implements AuditorAware&lt;String&gt; {
    @Override
    public Optional&lt;String&gt; getCurrentAuditor() {
        if(SecurityContextHolder.getContext().getAuthentication() == null || SecurityContextHolder.getContext().getAuthentication().getPrincipal().equals("anonymousUser")) {
            return Optional.of("admin@gmail.com");
        } else {
            return Optional.of(((User) SecurityContextHolder.getContext().getAuthentication().getPrincipal()).getEmail());
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next we want to make sure these click event listeners aren&#8217;t created if you&#8217;re not logged in.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">&lt;script sec:authorize="isFullyAuthenticated()"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Given that our REST API is wide open and its a GET anyone could pop a link into the address bar and vote. We want to prevent that and make sure only logged in users with the role of <code>ROLE_USER</code> can hit it. To do so we can use an annotation from <code>Spring Security</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Secured({"ROLE_USER"})
@GetMapping("/vote/link/{linkID}/direction/{direction}/votecount/{voteCount}")
public int vote(@PathVariable Long linkID, @PathVariable short direction, @PathVariable int voteCount) {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable this we need to add one more annotation to our Security Configuration class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebSecurity
@EnableGlobalMethodSecurity(securedEnabled = true)
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {

    ...

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And with that I think we have a pretty solid voting mechanism. We can of course improve upon it but for now I think it works pretty well.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_comments">Comments</h3>
<div class="paragraph">
<p>The last piece of the UI puzzle is comments. We need to be able to list comments out for each link and we want to allow logged in users to add a new comment.</p>
</div>
<div class="sect3">
<h4 id="_databaseloader">DatabaseLoader</h4>
<div class="paragraph">
<p>We are going to add something to our <code>CommandLineRunner</code> so we can add some test data into our application.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">links.forEach((k,v) -&gt; {
    Link link = new Link(k,v);
    linkRepository.save(link);

    // we will do something with comments later
    Comment spring = new Comment("Thank you for this link related to Spring Boot. I love it, great post!",link);
    Comment security = new Comment("I love that you're talking about Spring Security",link);
    Comment pwa = new Comment("What is this Progressive Web App thing all about? PWAs sound really cool.",link);
    Comment comments[] = {spring,security,pwa};
    for(Comment comment : comments) {
        commentRepository.save(comment);
        link.addComment(comment);
    }
});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_list_comments">List Comments</h4>
<div class="paragraph">
<p>Now that we have some data in our database we need to list out the comments on our link page. Remember back when we added that functionality to our Link domain to get a pretty time? Well we are going to do the same to comment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public String getPrettyTime() {
    PrettyTime pt = BeanUtil.getBean(PrettyTime.class);
    return pt.format(convertToDateViaInstant(getCreationDate()));
}

private Date convertToDateViaInstant(LocalDateTime dateToConvert) {
    return java.util.Date.from(dateToConvert.atZone(ZoneId.systemDefault()).toInstant());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Update the single comment display to loop over the list of comments for this link.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!-- single comment --&gt;
&lt;div class="row comment" th:each="comment : ${link.getComments()}"&gt;
    &lt;div class="col-1"&gt;&amp;nbsp;&lt;/div&gt;
    &lt;div class="col-11"&gt;
        &lt;span&gt;&lt;a href="#" th:text="${comment.getCreatedBy()}"&gt;&lt;i class="far fa-user"&gt;&lt;/i&gt; therealdanvega&lt;/a&gt;&lt;/span&gt;
        &lt;span th:text="${comment.getPrettyTime()}"&gt;&lt;i class="far fa-clock"&gt;&lt;/i&gt; 4 hours ago&lt;/span&gt;
        &lt;p class="body" th:text="${comment.getBody()}"&gt;It’s one thing I never care about, new releases of maven. Yet I do for most other things.. I really should take a look at any features released in the last while! Pull my dependencies, run my tests and upload to nexus. I don’t care for much else, I wonder what if any I’m missing.&lt;/p&gt;
        &lt;a href="#" class="permalink"&gt;&lt;i class="fas fa-link"&gt;&lt;/i&gt; permalink&lt;/a&gt;
        &lt;a href="#" class="like"&gt;&lt;i class="far fa-thumbs-up"&gt;&lt;/i&gt; Like&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_add_new_comment">Add New Comment</h4>
<div class="paragraph">
<p>The first thing we need to do is to update our add comment form. First, from the controllers perspective we will need to load an empty comment. To do that we will need to modify our read method in our <code>LinkController</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@GetMapping("/link/{id}")
public String read(@PathVariable Long id,Model model) {
    Optional&lt;Link&gt; link = linkRepository.findById(id);
    if( link.isPresent() ) {
        Link currentLink = link.get();
        Comment comment = new Comment();
        comment.setLink(currentLink);
        model.addAttribute("comment",comment);
        model.addAttribute("link",currentLink);
        model.addAttribute("success", model.containsAttribute("success"));
        return "link/view";
    } else {
        return "redirect:/";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next we will update our add form to contain a little bit more information. We need to add a form action and object. We also need to add a hidden field for the link because this isn&#8217;t something the user selects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;div class="row addcomment" sec:authorize="hasRole('ROLE_USER')"&gt;
    &lt;div class="col-1"&gt;&amp;nbsp;&lt;/div&gt;
    &lt;div class="col-11"&gt;
        &lt;form id="frmAddLink" method="POST" th:action="@{/link/comments}" th:object="${comment}"&gt;
            &lt;input type="hidden" th:field="*{link}"/&gt;
            &lt;div class="form-group"&gt;
                &lt;textarea class="form-control" id="comment" rows="3" th:field="*{body}"&gt;&lt;/textarea&gt;
            &lt;/div&gt;
            &lt;button type="submit" class="btn btn-primary"&gt;Add Comment&lt;/button&gt;
        &lt;/form&gt;
    &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You might think to  create a new Comment Controller but we don&#8217;t actually have to. Comments belong to this particular link so adding a new mapping to handle the post right in our <code>LinkController</code> is just fine.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostMapping("/link/comments")
public String addComment(@Valid Comment comment, BindingResult bindingResult, Model model, RedirectAttributes redirectAttributes) {
    if( bindingResult.hasErrors() ) {
        logger.info("Something went wrong.");
    } else {
        logger.info("New Comment Saved!");
        commentRepository.save(comment);
    }
    return "redirect:/link/" + comment.getLink().getId();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spring_mvc_the_service_layer">Spring MVC: The Service Layer</h3>
<div class="paragraph">
<p>When we started creating our controllers I didn&#8217;t spend a lot of time on what should go in there because I just wanted us to start writing code. Now that our application has taken shape I want to revisit that.</p>
</div>
<div class="paragraph">
<p>Controllers are supposed to be "thin" and shouldn&#8217;t contain any real business logic. The controllers job is to simply handle the request and move the user into the correct view or return the response in an API call.</p>
</div>
<div class="paragraph">
<p>If that&#8217;s the case then where do we put all of our business logic? The answer is of course in the service layer. As you might have already noticed there is no S in MVC but this is one of those patterns that has become standard over the years. In this section we are going to cover:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What is a Service class and what should it contain</p>
</li>
<li>
<p>How to create a Service class</p>
</li>
<li>
<p>Creating a User Service</p>
</li>
<li>
<p>Refactoring our existing controllers</p>
</li>
<li>
<p>@Transactional What is it and why do we need it</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_user_service">User Service</h4>
<div class="paragraph">
<p>We are going to start off by creating a User Service in this section. Let&#8217;s start to think about some of the methods that might go into our User Service.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Register</p>
</li>
<li>
<p>Save the new user</p>
</li>
<li>
<p>Send Activation Email</p>
</li>
<li>
<p>Optional&lt;User&gt; findByInd(Long id)</p>
</li>
<li>
<p>User save(User user)</p>
</li>
<li>
<p>Send Activation Email</p>
</li>
<li>
<p>Find User By Email &amp; Activation Code</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You will often find that your service is going to contain a lot of the methods the repository contains and that is ok, it will also contain some methods the repository doesn&#8217;t.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now that we know what logic our user service might contain let&#8217;s start to build out the stub for it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class UserService {

    private final Logger logger = LoggerFactory.getLogger(UserService.class);
    private final RoleService roleService;
    private final UserRepository userRepository;

    public UserService(RoleService roleService, UserRepository userRepository) {
        this.roleService = roleService;
        this.userRepository = userRepository;
    }

    public User register(User user) {

    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now how can we use our new User Service class in our Authentication Controller.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Controller
public class AuthController {

    private static final Logger logger = LoggerFactory.getLogger(AuthController.class);
    private UserService userService;

    public AuthController(UserService userService) {
        this.userService = userService;
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This doesn&#8217;t work right away because we haven&#8217;t asked Spring to manage this class as a bean for us. We could use the top level stereotype <code>@Component</code> but Spring provides a special one for Service classes, appropriately named <code>@Service</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Service
public class UserService {

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_transactional">@Transactional</h4>
<div class="paragraph">
<p>The first question we need to answer is: What is a transaction? I think the best way to answer that question is to look at an example.</p>
</div>
<div class="paragraph">
<p>Say for instance we had a method that accepted 1 or 1000 users. Our job is to batch save a list user but if any one of them fails we shouldn&#8217;t insert any.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void saveUsers(User... users) {
    for(User user : users) {
        logger.info("Saving User: " + user.getFullName());
        userRepository.save(user);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this scenario we can use a transaction to begin our method and then if any problems come up we can rollback the transaction or if everything went fine we can commit it. In this example if we saved 10 users and then hit a problem we would rollback the transaction and no users would be persisted to the database. Here is what the above method looks like from a high level under the hood when we enable transactions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void saveUsers(User... users) {
    // begin transaction
    for(User user : users) {
        logger.info("Saving User: " + user.getFullName());
        try {
            userRepository.save(user);
        } catch(Exception e) {
            // rollback transaction
        }
    }
    // commit transaction
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to enable transaction management in Spring you will need to use the <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/transaction/annotation/EnableTransactionManagement.html++">@EnableTransactionManagement</a> annotation on a configuration class. For the purposes of this application we can simply add it to our main application class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@SpringBootApplication
@EnableJpaAuditing
@EnableTransactionManagement
public class SpringitApplication {

    ...

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that we have enabled Transaction management we can use the <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/transaction/annotation/Transactional.html++">@Transactional</a> annotation on our classes or methods. If we use the annotation at the class level all public methods within that class will be marked with <code>@Transactional</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Service
@Transactional
public class UserService {

    // will be marked with @Transactional
    public User register() {
        return null;
    }

    // will NOT be marked with @Transactional
    private void logUserRegistration() {

    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also mark your methods as Transactional.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Service
@Transactional
public class UserService {

    @Transactional
    public User register() {
        return null;
    }

    private void logUserRegistration() {

    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The reason you might mix and match these is because the <code>@Transactional</code> annotation has some properties that you can use to customize the transaction.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>Isolation Level</strong> of the transaction.</p>
</li>
<li>
<p>The <strong>Propogation Type</strong> of the transaction.</p>
</li>
<li>
<p>A <strong>readOnly</strong> flag that can be set to true if the transaction is effectively read-only, allowing for corresponding optimizations at runtime.</p>
</li>
<li>
<p>A <strong>Timeout</strong> for the operation to be wrapped by the transaction</p>
</li>
<li>
<p>The <strong>Rollback</strong> rules for the transaction.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This means if I knew that all of my methods but 1 were going to be Read Only I could set that at the class level and override the 1 at the method level.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Service
@Transactional(readOnly=true)
public class UserService {

    @Transaction(readOnly=false)
    public User register() {
        return null;
    }

    public User findById(Long id) {
        return userRepository.findById(id);
    }

    public User findByEmail(String email) {
        return userRepository.findByEmail(email);
    }
    ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_registration_process">Registration process</h4>
<div class="paragraph">
<p>What are we going to cover in this section?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What is the service layer for</p>
</li>
<li>
<p>Creating a User Service</p>
</li>
<li>
<p>User Refactoring</p>
</li>
<li>
<p>Registration form</p>
</li>
<li>
<p>Registration Process</p>
</li>
<li>
<p>Setting up a local email server</p>
</li>
<li>
<p>@Transactional</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_user_refactoring">User Refactoring</h4>
<div class="paragraph">
<p>One of the major problems I have with this application is that we are displaying the users email address next to link or comment. We wouldn&#8217;t ever want to show a users email address to the public like this and we need to fix it.</p>
</div>
<div class="paragraph">
<p>We could have just used an actual username as the username in Spring Security and this would have solved our problem. In fact if we were building a real system here we would do that but I wanted to set it up like this to show a couple of things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Refactoring</p>
</li>
<li>
<p>User Associations vs Auditing</p>
</li>
<li>
<p>Transient Properties</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @NonNull
    @NotNull(message = "You must enter a first name.")
    private String firstName;

    @NonNull
    @NotNull(message = "You must enter a lastName name.")
    private String lastName;

    @Transient
    @Setter(AccessLevel.NONE)
    private String fullName;

    @NonNull
    @NotNull
    @Column(nullable = false, unique = true)
    private String alias;

    public String getFullName(){
        return firstName + " " + lastName;
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>When we make these changes we to need to update our database loader.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_registration_form">Registration Form</h4>
<div class="paragraph">
<p>show a picture of what our form originally looked like</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/springit_registration_form.png" alt="springit registration form">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_registration_controller">Registration Controller</h4>

</div>
<div class="sect3">
<h4 id="_registration_process_2">Registration Process</h4>

</div>
<div class="sect3">
<h4 id="_local_email_server_setup">Local Email Server Setup</h4>
<div class="paragraph">
<p><a href="https://github.com/djfarrelly/MailDev" class="bare">https://github.com/djfarrelly/MailDev</a>
<a href="https://mailtrap.io/" class="bare">https://mailtrap.io/</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_exercise_refactor_existing_controllers">Exercise: Refactor Existing Controllers</h4>
<div class="paragraph">
<p>We want to have the students refactor the link comment and vote controllers</p>
</div>
</div>
<div class="sect3">
<h4 id="_alias_availability_feature">Alias Availability Feature</h4>

</div>
<div class="sect3">
<h4 id="_transactional_2">@Transactional</h4>

</div>
<div class="sect3">
<h4 id="_custom_password_validatior">Custom password validatior</h4>
<div class="paragraph">
<p>make sure we update the database loader when we do this</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_spring_documentation">Spring Documentation</h3>
<div class="paragraph">
<p>There are a ton of great resources out there but I want to start with the documentation. The documentation for Spring Framework and Spring Boot has really improved over the years. I love some of the dedicated guides we got this time around with Actuator and the Gradle Plugin. </p>
</div>
<div class="sect3">
<h4 id="_spring_framework_5_2">Spring Framework 5</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/">Spring Framework Reference Documentation</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#spring-core">Spring Core</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/testing.html#testing">Testing</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/data-access.html#spring-data-tier">Data Access</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html#spring-web">Web Servlet</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/web-reactive.html#spring-webflux">Web Reactive</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#spring-integration">Integration</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/languages.html#languages">Languages</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://docs.spring.io/spring/docs/5.0.5.RELEASE/javadoc-api/">Spring Framework 5 API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_spring_boot">Spring Boot</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.0.x/reference/html/">Spring Boot Reference Guide</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.0.x/api/">Spring Boot API</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.0.x/actuator-api/html/">Spring Boot Actuator Web API</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.0.x/gradle-plugin/reference/html/">Spring Boot Gradle Plugin Reference</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.0.x/maven-plugin/">Spring Boot Maven Plugin Reference</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.0.x/reference/html/common-application-properties.html">Common Application Properties</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spring_source_code">Spring Source Code</h3>
<div class="sect3">
<h4 id="_spring_framework">Spring Framework</h4>
<div class="paragraph">
<p><a href="https://github.com/spring-projects/spring-framework" class="bare">https://github.com/spring-projects/spring-framework</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_spring_boot_3">Spring Boot</h4>
<div class="paragraph">
<p><a href="https://github.com/spring-projects/spring-boot" class="bare">https://github.com/spring-projects/spring-boot</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_books">Books</h3>

</div>
<div class="sect2">
<h3 id="_websites">Websites</h3>

</div>
<div class="sect2">
<h3 id="_blog">Blog</h3>

</div>
<div class="sect2">
<h3 id="_twitter">Twitter</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_join_our_community">Join our Community</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have started a brand new community for Spring Boot Developers. I want to invite all of you to a new private
Facebook community that I recently started. This is a place for developers to talk about projects that they are
working on, share new tips and tricks and even get help with problems that they are running into in their day to day
development. I will be sharing some of my favorite books, courses and tutorials that will help you sharpen your
Spring Development skills. This should be a fun place for all of us to hang out, so head on over and sign up.
I can’t wait to chat with you!</p>
</div>
<div class="paragraph">
<p><a href="https://www.facebook.com/groups/157072618416340/" class="bare">https://www.facebook.com/groups/157072618416340/</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contact_me">Contact Me</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dan Vega<br>
<a href="mailto:danvega@gmail.com">danvega@gmail.com</a><br>
<a href="http://www.therealdanvega.com" class="bare">http://www.therealdanvega.com</a><br></p>
</div>
<div class="paragraph">
<p><strong>Social Media</strong></p>
</div>
<div class="paragraph">
<p><a href="http://www.facebook.com/therealdanvega">Facebook</a> |
<a href="http://www.twitter.com/therealdanvega">Twitter</a> |
<a href="http://www.instagram.com/thedanvega">Instagram</a> |
<a href="http://www.youtube.com/therealdanvega/">YouTube</a> |
<a href="https://www.linkedin.com/in/danvega/">LinkedIn</a> |
<a href="https://github.com/cfaddict/">Github</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.1<br>
Last updated 2018-10-27 07:39:37 EDT
</div>
</div>
<script src="prism/prism.js"></script>
</body>
</html>